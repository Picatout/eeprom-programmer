ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 1.
Hexadecimal [24-Bits]



                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2025  
                                      3 ; This file is part of eeprom-programmer 
                                      4 ;
                                      5 ;     eeprom-programmer is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     eeprom-programmer is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with eeprom-programmer.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 
                                     19 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     20 ;;; hardware initialisation
                                     21 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
                                     22 
                                     23 ;------------------------
                                     24 ; if unified compilation 
                                     25 ; must be first in list 
                                     26 ;-----------------------
                                     27 
                                     28     .module HW_INIT 
                                     29 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 2.
Hexadecimal [24-Bits]



                                     30     .include "config.inc"
                                      1 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                      2 ;;  configuration parameters 
                                      3 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                      4 
                           000001     5     MAJOR=1
                           000000     6     MINOR=0
                           000005     7     REV=5
                                      8 
                           000010     9     FMSTR=16 ; master clock frequency in Mhz 
                                     10 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 3.
Hexadecimal [24-Bits]



                                     11     .include "inc/stm8s208.inc" 
                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2019 
                                      3 ; This file is part of MONA 
                                      4 ;
                                      5 ;     MONA is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     MONA is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with MONA.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     19 ; 2019/10/18
                                     20 ; STM8S208RB µC registers map
                                     21 ; sdas source file
                                     22 ; author: Jacques Deschênes, copyright 2018,2019
                                     23 ; licence: GPLv3
                                     24 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     25 	.module stm8s208rb
                                     26 
                                     27 ;;;;;;;;;;;;
                                     28 ; bits
                                     29 ;;;;;;;;;;;;
                           000000    30  BIT0 = 0
                           000001    31  BIT1 = 1
                           000002    32  BIT2 = 2
                           000003    33  BIT3 = 3
                           000004    34  BIT4 = 4
                           000005    35  BIT5 = 5
                           000006    36  BIT6 = 6
                           000007    37  BIT7 = 7
                                     38  	
                                     39 ;;;;;;;;;;;;
                                     40 ; bits masks
                                     41 ;;;;;;;;;;;;
                           000001    42  B0_MASK = (1<<0)
                           000002    43  B1_MASK = (1<<1)
                           000004    44  B2_MASK = (1<<2)
                           000008    45  B3_MASK = (1<<3)
                           000010    46  B4_MASK = (1<<4)
                           000020    47  B5_MASK = (1<<5)
                           000040    48  B6_MASK = (1<<6)
                           000080    49  B7_MASK = (1<<7)
                                     50 
                                     51 ; HSI oscillator frequency 16Mhz
                           F42400    52  FHSI = 16000000
                                     53 ; LSI oscillator frequency 128Khz
                           01F400    54  FLSI = 128000 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 4.
Hexadecimal [24-Bits]



                                     55 
                                     56 ; controller memory regions
                           001800    57  RAM_SIZE = (0x1800) ; 6KB 
                           000800    58  EEPROM_SIZE = (0x800) ; 2KB
                                     59 ; STM8S208RB have 128K flash
                           020000    60  FLASH_SIZE = (0x20000)
                                     61 ; erase block size 
                           000080    62 BLOCK_SIZE=128 
                                     63 
                           000000    64  RAM_BASE = (0)
                           0017FF    65  RAM_END = (RAM_BASE+RAM_SIZE-1)
                           004000    66  EEPROM_BASE = (0x4000)
                           0047FF    67  EEPROM_END = (EEPROM_BASE+EEPROM_SIZE-1)
                           005000    68  SFR_BASE = (0x5000)
                           0057FF    69  SFR_END = (0x57FF)
                           006000    70  BOOT_ROM_BASE = (0x6000)
                           007FFF    71  BOOT_ROM_END = (0x7fff)
                           008000    72  FLASH_BASE = (0x8000)
                           027FFF    73  FLASH_END = (FLASH_BASE+FLASH_SIZE-1)
                           004800    74  OPTION_BASE = (0x4800)
                           000080    75  OPTION_SIZE = (0x80)
                           00487F    76  OPTION_END = (OPTION_BASE+OPTION_SIZE-1)
                           0048CD    77  DEVID_BASE = (0x48CD)
                           0048D8    78  DEVID_END = (0x48D8)
                           007F00    79  DEBUG_BASE = (0X7F00)
                           007FFF    80  DEBUG_END = (0X7FFF)
                                     81 
                                     82 ; options bytes
                                     83 ; this one can be programmed only from SWIM  (ICP)
                           004800    84  OPT0  = (0x4800)
                                     85 ; these can be programmed at runtime (IAP)
                           004801    86  OPT1  = (0x4801)
                           004802    87  NOPT1  = (0x4802)
                           004803    88  OPT2  = (0x4803)
                           004804    89  NOPT2  = (0x4804)
                           004805    90  OPT3  = (0x4805)
                           004806    91  NOPT3  = (0x4806)
                           004807    92  OPT4  = (0x4807)
                           004808    93  NOPT4  = (0x4808)
                           004809    94  OPT5  = (0x4809)
                           00480A    95  NOPT5  = (0x480A)
                           00480B    96  OPT6  = (0x480B)
                           00480C    97  NOPT6 = (0x480C)
                           00480D    98  OPT7 = (0x480D)
                           00480E    99  NOPT7 = (0x480E)
                           00487E   100  OPTBL  = (0x487E)
                           00487F   101  NOPTBL  = (0x487F)
                                    102 ; option registers usage
                                    103 ; read out protection, value 0xAA enable ROP
                           004800   104  ROP = OPT0  
                                    105 ; user boot code, {0..0x3e} 512 bytes row
                           004801   106  UBC = OPT1
                           004802   107  NUBC = NOPT1
                                    108 ; alternate function register
                           004803   109  AFR = OPT2
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 5.
Hexadecimal [24-Bits]



                           004804   110  NAFR = NOPT2
                                    111 ; miscelinous options
                           004805   112  WDGOPT = OPT3
                           004806   113  NWDGOPT = NOPT3
                                    114 ; clock options
                           004807   115  CLKOPT = OPT4
                           004808   116  NCLKOPT = NOPT4
                                    117 ; HSE clock startup delay
                           004809   118  HSECNT = OPT5
                           00480A   119  NHSECNT = NOPT5
                                    120 ; flash wait state
                           00480D   121 FLASH_WS = OPT7
                           00480E   122 NFLASH_WS = NOPT7
                                    123 
                                    124 ; watchdog options bits
                           000003   125   WDGOPT_LSIEN   =  BIT3
                           000002   126   WDGOPT_IWDG_HW =  BIT2
                           000001   127   WDGOPT_WWDG_HW =  BIT1
                           000000   128   WDGOPT_WWDG_HALT = BIT0
                                    129 ; NWDGOPT bits
                           FFFFFFFC   130   NWDGOPT_LSIEN    = ~BIT3
                           FFFFFFFD   131   NWDGOPT_IWDG_HW  = ~BIT2
                           FFFFFFFE   132   NWDGOPT_WWDG_HW  = ~BIT1
                           FFFFFFFF   133   NWDGOPT_WWDG_HALT = ~BIT0
                                    134 
                                    135 ; CLKOPT bits
                           000003   136  CLKOPT_EXT_CLK  = BIT3
                           000002   137  CLKOPT_CKAWUSEL = BIT2
                           000001   138  CLKOPT_PRS_C1   = BIT1
                           000000   139  CLKOPT_PRS_C0   = BIT0
                                    140 
                                    141 ; AFR option, remapable functions
                           000007   142  AFR7_BEEP    = BIT7
                           000006   143  AFR6_I2C     = BIT6
                           000005   144  AFR5_TIM1    = BIT5
                           000004   145  AFR4_TIM1    = BIT4
                           000003   146  AFR3_TIM1    = BIT3
                           000002   147  AFR2_CCO     = BIT2
                           000001   148  AFR1_TIM2    = BIT1
                           000000   149  AFR0_ADC     = BIT0
                                    150 
                                    151 ; device ID = (read only)
                           0048CD   152  DEVID_XL  = (0x48CD)
                           0048CE   153  DEVID_XH  = (0x48CE)
                           0048CF   154  DEVID_YL  = (0x48CF)
                           0048D0   155  DEVID_YH  = (0x48D0)
                           0048D1   156  DEVID_WAF  = (0x48D1)
                           0048D2   157  DEVID_LOT0  = (0x48D2)
                           0048D3   158  DEVID_LOT1  = (0x48D3)
                           0048D4   159  DEVID_LOT2  = (0x48D4)
                           0048D5   160  DEVID_LOT3  = (0x48D5)
                           0048D6   161  DEVID_LOT4  = (0x48D6)
                           0048D7   162  DEVID_LOT5  = (0x48D7)
                           0048D8   163  DEVID_LOT6  = (0x48D8)
                                    164 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 6.
Hexadecimal [24-Bits]



                                    165 
                           005000   166 GPIO_BASE = (0x5000)
                           000005   167 GPIO_SIZE = (5)
                                    168 ; PORTS SFR OFFSET
                           000000   169 PA = 0
                           000005   170 PB = 5
                           00000A   171 PC = 10
                           00000F   172 PD = 15
                           000014   173 PE = 20
                           000019   174 PF = 25
                           00001E   175 PG = 30
                           000023   176 PH = 35 
                           000028   177 PI = 40 
                                    178 
                                    179 ; GPIO
                                    180 ; gpio register offset to base
                           000000   181  GPIO_ODR = 0
                           000001   182  GPIO_IDR = 1
                           000002   183  GPIO_DDR = 2
                           000003   184  GPIO_CR1 = 3
                           000004   185  GPIO_CR2 = 4
                           005000   186  GPIO_BASE=(0X5000)
                                    187  
                                    188 ; port A
                           005000   189  PA_BASE = (0X5000)
                           005000   190  PA_ODR  = (0x5000)
                           005001   191  PA_IDR  = (0x5001)
                           005002   192  PA_DDR  = (0x5002)
                           005003   193  PA_CR1  = (0x5003)
                           005004   194  PA_CR2  = (0x5004)
                                    195 ; port B
                           005005   196  PB_BASE = (0X5005)
                           005005   197  PB_ODR  = (0x5005)
                           005006   198  PB_IDR  = (0x5006)
                           005007   199  PB_DDR  = (0x5007)
                           005008   200  PB_CR1  = (0x5008)
                           005009   201  PB_CR2  = (0x5009)
                                    202 ; port C
                           00500A   203  PC_BASE = (0X500A)
                           00500A   204  PC_ODR  = (0x500A)
                           00500B   205  PC_IDR  = (0x500B)
                           00500C   206  PC_DDR  = (0x500C)
                           00500D   207  PC_CR1  = (0x500D)
                           00500E   208  PC_CR2  = (0x500E)
                                    209 ; port D
                           00500F   210  PD_BASE = (0X500F)
                           00500F   211  PD_ODR  = (0x500F)
                           005010   212  PD_IDR  = (0x5010)
                           005011   213  PD_DDR  = (0x5011)
                           005012   214  PD_CR1  = (0x5012)
                           005013   215  PD_CR2  = (0x5013)
                                    216 ; port E
                           005014   217  PE_BASE = (0X5014)
                           005014   218  PE_ODR  = (0x5014)
                           005015   219  PE_IDR  = (0x5015)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 7.
Hexadecimal [24-Bits]



                           005016   220  PE_DDR  = (0x5016)
                           005017   221  PE_CR1  = (0x5017)
                           005018   222  PE_CR2  = (0x5018)
                                    223 ; port F
                           005019   224  PF_BASE = (0X5019)
                           005019   225  PF_ODR  = (0x5019)
                           00501A   226  PF_IDR  = (0x501A)
                           00501B   227  PF_DDR  = (0x501B)
                           00501C   228  PF_CR1  = (0x501C)
                           00501D   229  PF_CR2  = (0x501D)
                                    230 ; port G
                           00501E   231  PG_BASE = (0X501E)
                           00501E   232  PG_ODR  = (0x501E)
                           00501F   233  PG_IDR  = (0x501F)
                           005020   234  PG_DDR  = (0x5020)
                           005021   235  PG_CR1  = (0x5021)
                           005022   236  PG_CR2  = (0x5022)
                                    237 ; port H not present on LQFP48/LQFP64 package
                           005023   238  PH_BASE = (0X5023)
                           005023   239  PH_ODR  = (0x5023)
                           005024   240  PH_IDR  = (0x5024)
                           005025   241  PH_DDR  = (0x5025)
                           005026   242  PH_CR1  = (0x5026)
                           005027   243  PH_CR2  = (0x5027)
                                    244 ; port I ; only bit 0 on LQFP64 package, not present on LQFP48
                           005028   245  PI_BASE = (0X5028)
                           005028   246  PI_ODR  = (0x5028)
                           005029   247  PI_IDR  = (0x5029)
                           00502A   248  PI_DDR  = (0x502a)
                           00502B   249  PI_CR1  = (0x502b)
                           00502C   250  PI_CR2  = (0x502c)
                                    251 
                                    252 ; input modes CR1
                           000000   253  INPUT_FLOAT = (0) ; no pullup resistor
                           000001   254  INPUT_PULLUP = (1)
                                    255 ; output mode CR1
                           000000   256  OUTPUT_OD = (0) ; open drain
                           000001   257  OUTPUT_PP = (1) ; push pull
                                    258 ; input modes CR2
                           000000   259  INPUT_DI = (0)
                           000001   260  INPUT_EI = (1)
                                    261 ; output speed CR2
                           000000   262  OUTPUT_SLOW = (0)
                           000001   263  OUTPUT_FAST = (1)
                                    264 
                                    265 
                                    266 ; Flash memory
                           000080   267  BLOCK_SIZE=128 
                           00505A   268  FLASH_CR1  = (0x505A)
                           00505B   269  FLASH_CR2  = (0x505B)
                           00505C   270  FLASH_NCR2  = (0x505C)
                           00505D   271  FLASH_FPR  = (0x505D)
                           00505E   272  FLASH_NFPR  = (0x505E)
                           00505F   273  FLASH_IAPSR  = (0x505F)
                           005062   274  FLASH_PUKR  = (0x5062)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 8.
Hexadecimal [24-Bits]



                           005064   275  FLASH_DUKR  = (0x5064)
                                    276 ; data memory unlock keys
                           0000AE   277  FLASH_DUKR_KEY1 = (0xae)
                           000056   278  FLASH_DUKR_KEY2 = (0x56)
                                    279 ; flash memory unlock keys
                           000056   280  FLASH_PUKR_KEY1 = (0x56)
                           0000AE   281  FLASH_PUKR_KEY2 = (0xae)
                                    282 ; FLASH_CR1 bits
                           000003   283  FLASH_CR1_HALT = BIT3
                           000002   284  FLASH_CR1_AHALT = BIT2
                           000001   285  FLASH_CR1_IE = BIT1
                           000000   286  FLASH_CR1_FIX = BIT0
                                    287 ; FLASH_CR2 bits
                           000007   288  FLASH_CR2_OPT = BIT7
                           000006   289  FLASH_CR2_WPRG = BIT6
                           000005   290  FLASH_CR2_ERASE = BIT5
                           000004   291  FLASH_CR2_FPRG = BIT4
                           000000   292  FLASH_CR2_PRG = BIT0
                                    293 ; FLASH_FPR bits
                           000005   294  FLASH_FPR_WPB5 = BIT5
                           000004   295  FLASH_FPR_WPB4 = BIT4
                           000003   296  FLASH_FPR_WPB3 = BIT3
                           000002   297  FLASH_FPR_WPB2 = BIT2
                           000001   298  FLASH_FPR_WPB1 = BIT1
                           000000   299  FLASH_FPR_WPB0 = BIT0
                                    300 ; FLASH_NFPR bits
                           000005   301  FLASH_NFPR_NWPB5 = BIT5
                           000004   302  FLASH_NFPR_NWPB4 = BIT4
                           000003   303  FLASH_NFPR_NWPB3 = BIT3
                           000002   304  FLASH_NFPR_NWPB2 = BIT2
                           000001   305  FLASH_NFPR_NWPB1 = BIT1
                           000000   306  FLASH_NFPR_NWPB0 = BIT0
                                    307 ; FLASH_IAPSR bits
                           000006   308  FLASH_IAPSR_HVOFF = BIT6
                           000003   309  FLASH_IAPSR_DUL = BIT3
                           000002   310  FLASH_IAPSR_EOP = BIT2
                           000001   311  FLASH_IAPSR_PUL = BIT1
                           000000   312  FLASH_IAPSR_WR_PG_DIS = BIT0
                                    313 
                                    314 ; Interrupt control
                           0050A0   315  EXTI_CR1  = (0x50A0)
                           0050A1   316  EXTI_CR2  = (0x50A1)
                                    317 
                                    318 ; Reset Status
                           0050B3   319  RST_SR  = (0x50B3)
                                    320 
                                    321 ; Clock Registers
                           0050C0   322  CLK_ICKR  = (0x50c0)
                           0050C1   323  CLK_ECKR  = (0x50c1)
                           0050C3   324  CLK_CMSR  = (0x50C3)
                           0050C4   325  CLK_SWR  = (0x50C4)
                           0050C5   326  CLK_SWCR  = (0x50C5)
                           0050C6   327  CLK_CKDIVR  = (0x50C6)
                           0050C7   328  CLK_PCKENR1  = (0x50C7)
                           0050C8   329  CLK_CSSR  = (0x50C8)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 9.
Hexadecimal [24-Bits]



                           0050C9   330  CLK_CCOR  = (0x50C9)
                           0050CA   331  CLK_PCKENR2  = (0x50CA)
                           0050CC   332  CLK_HSITRIMR  = (0x50CC)
                           0050CD   333  CLK_SWIMCCR  = (0x50CD)
                                    334 
                                    335 ; Peripherals clock gating
                                    336 ; CLK_PCKENR1 
                           000007   337  CLK_PCKENR1_TIM1 = (7)
                           000006   338  CLK_PCKENR1_TIM3 = (6)
                           000005   339  CLK_PCKENR1_TIM2 = (5)
                           000004   340  CLK_PCKENR1_TIM4 = (4)
                           000003   341  CLK_PCKENR1_UART3 = (3)
                           000002   342  CLK_PCKENR1_UART1 = (2)
                           000001   343  CLK_PCKENR1_SPI = (1)
                           000000   344  CLK_PCKENR1_I2C = (0)
                                    345 ; CLK_PCKENR2
                           000007   346  CLK_PCKENR2_CAN = (7)
                           000003   347  CLK_PCKENR2_ADC = (3)
                           000002   348  CLK_PCKENR2_AWU = (2)
                                    349 
                                    350 ; Clock bits
                           000005   351  CLK_ICKR_REGAH = (5)
                           000004   352  CLK_ICKR_LSIRDY = (4)
                           000003   353  CLK_ICKR_LSIEN = (3)
                           000002   354  CLK_ICKR_FHW = (2)
                           000001   355  CLK_ICKR_HSIRDY = (1)
                           000000   356  CLK_ICKR_HSIEN = (0)
                                    357 
                           000001   358  CLK_ECKR_HSERDY = (1)
                           000000   359  CLK_ECKR_HSEEN = (0)
                                    360 ; clock source
                           0000E1   361  CLK_SWR_HSI = 0xE1
                           0000D2   362  CLK_SWR_LSI = 0xD2
                           0000B4   363  CLK_SWR_HSE = 0xB4
                                    364 
                           000003   365  CLK_SWCR_SWIF = (3)
                           000002   366  CLK_SWCR_SWIEN = (2)
                           000001   367  CLK_SWCR_SWEN = (1)
                           000000   368  CLK_SWCR_SWBSY = (0)
                                    369 
                           000004   370  CLK_CKDIVR_HSIDIV1 = (4)
                           000003   371  CLK_CKDIVR_HSIDIV0 = (3)
                           000002   372  CLK_CKDIVR_CPUDIV2 = (2)
                           000001   373  CLK_CKDIVR_CPUDIV1 = (1)
                           000000   374  CLK_CKDIVR_CPUDIV0 = (0)
                                    375 
                                    376 ; Watchdog
                           0050D1   377  WWDG_CR  = (0x50D1)
                           0050D2   378  WWDG_WR  = (0x50D2)
                           0050E0   379  IWDG_KR  = (0x50E0)
                           0050E1   380  IWDG_PR  = (0x50E1)
                           0050E2   381  IWDG_RLR  = (0x50E2)
                           0000CC   382  IWDG_KEY_ENABLE = 0xCC  ; enable IWDG key 
                           0000AA   383  IWDG_KEY_REFRESH = 0xAA ; refresh counter key 
                           000055   384  IWDG_KEY_ACCESS = 0x55 ; write register key 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 10.
Hexadecimal [24-Bits]



                                    385  
                           0050F0   386  AWU_CSR  = (0x50F0)
                           0050F1   387  AWU_APR  = (0x50F1)
                           0050F2   388  AWU_TBR  = (0x50F2)
                           000004   389  AWU_CSR_AWUEN = 4
                                    390 
                                    391 
                                    392 
                                    393 ; Beeper
                                    394 ; beeper output is alternate function AFR7 on PD4
                                    395 ; connected to CN9-6
                           0050F3   396  BEEP_CSR  = (0x50F3)
                           00000F   397  BEEP_PORT = PD
                           000004   398  BEEP_BIT = 4
                           000010   399  BEEP_MASK = B4_MASK
                                    400 
                                    401 ; SPI
                           005200   402  SPI_CR1  = (0x5200)
                           005201   403  SPI_CR2  = (0x5201)
                           005202   404  SPI_ICR  = (0x5202)
                           005203   405  SPI_SR  = (0x5203)
                           005204   406  SPI_DR  = (0x5204)
                           005205   407  SPI_CRCPR  = (0x5205)
                           005206   408  SPI_RXCRCR  = (0x5206)
                           005207   409  SPI_TXCRCR  = (0x5207)
                                    410 
                                    411 ; SPI_CR1 bit fields 
                           000000   412   SPI_CR1_CPHA=0
                           000001   413   SPI_CR1_CPOL=1
                           000002   414   SPI_CR1_MSTR=2
                           000003   415   SPI_CR1_BR=3
                           000006   416   SPI_CR1_SPE=6
                           000007   417   SPI_CR1_LSBFIRST=7
                                    418   
                                    419 ; SPI_CR2 bit fields 
                           000000   420   SPI_CR2_SSI=0
                           000001   421   SPI_CR2_SSM=1
                           000002   422   SPI_CR2_RXONLY=2
                           000004   423   SPI_CR2_CRCNEXT=4
                           000005   424   SPI_CR2_CRCEN=5
                           000006   425   SPI_CR2_BDOE=6
                           000007   426   SPI_CR2_BDM=7  
                                    427 
                                    428 ; SPI_SR bit fields 
                           000000   429   SPI_SR_RXNE=0
                           000001   430   SPI_SR_TXE=1
                           000003   431   SPI_SR_WKUP=3
                           000004   432   SPI_SR_CRCERR=4
                           000005   433   SPI_SR_MODF=5
                           000006   434   SPI_SR_OVR=6
                           000007   435   SPI_SR_BSY=7
                                    436 
                                    437 ; I2C
                           005210   438  I2C_BASE_ADDR = 0x5210 
                           005210   439  I2C_CR1  = (0x5210)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 11.
Hexadecimal [24-Bits]



                           005211   440  I2C_CR2  = (0x5211)
                           005212   441  I2C_FREQR  = (0x5212)
                           005213   442  I2C_OARL  = (0x5213)
                           005214   443  I2C_OARH  = (0x5214)
                           005216   444  I2C_DR  = (0x5216)
                           005217   445  I2C_SR1  = (0x5217)
                           005218   446  I2C_SR2  = (0x5218)
                           005219   447  I2C_SR3  = (0x5219)
                           00521A   448  I2C_ITR  = (0x521A)
                           00521B   449  I2C_CCRL  = (0x521B)
                           00521C   450  I2C_CCRH  = (0x521C)
                           00521D   451  I2C_TRISER  = (0x521D)
                           00521E   452  I2C_PECR  = (0x521E)
                                    453 
                           000007   454  I2C_CR1_NOSTRETCH = (7)
                           000006   455  I2C_CR1_ENGC = (6)
                           000000   456  I2C_CR1_PE = (0)
                                    457 
                           000007   458  I2C_CR2_SWRST = (7)
                           000003   459  I2C_CR2_POS = (3)
                           000002   460  I2C_CR2_ACK = (2)
                           000001   461  I2C_CR2_STOP = (1)
                           000000   462  I2C_CR2_START = (0)
                                    463 
                           000000   464  I2C_OARL_ADD0 = (0)
                                    465 
                           000009   466  I2C_OAR_ADDR_7BIT = ((I2C_OARL & 0xFE) >> 1)
                           000813   467  I2C_OAR_ADDR_10BIT = (((I2C_OARH & 0x06) << 9) | (I2C_OARL & 0xFF))
                                    468 
                           000007   469  I2C_OARH_ADDMODE = (7)
                           000006   470  I2C_OARH_ADDCONF = (6)
                           000002   471  I2C_OARH_ADD9 = (2)
                           000001   472  I2C_OARH_ADD8 = (1)
                                    473 
                           000007   474  I2C_SR1_TXE = (7)
                           000006   475  I2C_SR1_RXNE = (6)
                           000004   476  I2C_SR1_STOPF = (4)
                           000003   477  I2C_SR1_ADD10 = (3)
                           000002   478  I2C_SR1_BTF = (2)
                           000001   479  I2C_SR1_ADDR = (1)
                           000000   480  I2C_SR1_SB = (0)
                                    481 
                           000005   482  I2C_SR2_WUFH = (5)
                           000003   483  I2C_SR2_OVR = (3)
                           000002   484  I2C_SR2_AF = (2)
                           000001   485  I2C_SR2_ARLO = (1)
                           000000   486  I2C_SR2_BERR = (0)
                                    487 
                           000007   488  I2C_SR3_DUALF = (7)
                           000004   489  I2C_SR3_GENCALL = (4)
                           000002   490  I2C_SR3_TRA = (2)
                           000001   491  I2C_SR3_BUSY = (1)
                           000000   492  I2C_SR3_MSL = (0)
                                    493 
                           000002   494  I2C_ITR_ITBUFEN = (2)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 12.
Hexadecimal [24-Bits]



                           000001   495  I2C_ITR_ITEVTEN = (1)
                           000000   496  I2C_ITR_ITERREN = (0)
                                    497 
                           000007   498  I2C_CCRH_FAST = 7 
                           000006   499  I2C_CCRH_DUTY = 6 
                                    500  
                                    501 ; Precalculated values, all in KHz
                           000080   502  I2C_CCRH_16MHZ_FAST_400 = 0x80
                           00000D   503  I2C_CCRL_16MHZ_FAST_400 = 0x0D
                                    504 ;
                                    505 ; Fast I2C mode max rise time = 300ns
                                    506 ; I2C_FREQR = 16 = (MHz) => tMASTER = 1/16 = 62.5 ns
                                    507 ; TRISER = = (300/62.5) + 1 = floor(4.8) + 1 = 5.
                                    508 
                           000005   509  I2C_TRISER_16MHZ_FAST_400 = 0x05
                                    510 
                           0000C0   511  I2C_CCRH_16MHZ_FAST_320 = 0xC0
                           000002   512  I2C_CCRL_16MHZ_FAST_320 = 0x02
                           000005   513  I2C_TRISER_16MHZ_FAST_320 = 0x05
                                    514 
                           000080   515  I2C_CCRH_16MHZ_FAST_200 = 0x80
                           00001A   516  I2C_CCRL_16MHZ_FAST_200 = 0x1A
                           000005   517  I2C_TRISER_16MHZ_FAST_200 = 0x05
                                    518 
                           000000   519  I2C_CCRH_16MHZ_STD_100 = 0x00
                           000050   520  I2C_CCRL_16MHZ_STD_100 = 0x50
                                    521 ;
                                    522 ; Standard I2C mode max rise time = 1000ns
                                    523 ; I2C_FREQR = 16 = (MHz) => tMASTER = 1/16 = 62.5 ns
                                    524 ; TRISER = = (1000/62.5) + 1 = floor(16) + 1 = 17.
                                    525 
                           000011   526  I2C_TRISER_16MHZ_STD_100 = 0x11
                                    527 
                           000000   528  I2C_CCRH_16MHZ_STD_50 = 0x00
                           0000A0   529  I2C_CCRL_16MHZ_STD_50 = 0xA0
                           000011   530  I2C_TRISER_16MHZ_STD_50 = 0x11
                                    531 
                           000001   532  I2C_CCRH_16MHZ_STD_20 = 0x01
                           000090   533  I2C_CCRL_16MHZ_STD_20 = 0x90
                           000011   534  I2C_TRISER_16MHZ_STD_20 = 0x11;
                                    535 
                           000001   536  I2C_READ = 1
                           000000   537  I2C_WRITE = 0
                                    538 
                                    539 ; baudrate constant for brr_value table access
                                    540 ; to be used by uart_init 
                           000000   541 B2400=0
                           000001   542 B4800=1
                           000002   543 B9600=2
                           000003   544 B19200=3
                           000004   545 B38400=4
                           000005   546 B57600=5
                           000006   547 B115200=6
                           000007   548 B230400=7
                           000008   549 B460800=8
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 13.
Hexadecimal [24-Bits]



                           000009   550 B921600=9
                                    551 
                                    552 ; UART registers offset from
                                    553 ; base address 
                           000000   554 OFS_UART_SR=0
                           000001   555 OFS_UART_DR=1
                           000002   556 OFS_UART_BRR1=2
                           000003   557 OFS_UART_BRR2=3
                           000004   558 OFS_UART_CR1=4
                           000005   559 OFS_UART_CR2=5
                           000006   560 OFS_UART_CR3=6
                           000007   561 OFS_UART_CR4=7
                           000008   562 OFS_UART_CR5=8
                           000009   563 OFS_UART_CR6=9
                           000009   564 OFS_UART_GTR=9
                           00000A   565 OFS_UART_PSCR=10
                                    566 
                                    567 ; uart identifier
                           000000   568  UART1 = 0 
                           000001   569  UART2 = 1
                           000002   570  UART3 = 2
                                    571 
                                    572 ; pins used by uart 
                           000005   573 UART1_TX_PIN=BIT5
                           000004   574 UART1_RX_PIN=BIT4
                           000005   575 UART3_TX_PIN=BIT5
                           000006   576 UART3_RX_PIN=BIT6
                                    577 ; uart port base address 
                           000000   578 UART1_PORT=PA 
                           00000F   579 UART3_PORT=PD
                                    580 
                                    581 ; UART1 
                           005230   582  UART1_BASE  = (0x5230)
                           005230   583  UART1_SR    = (0x5230)
                           005231   584  UART1_DR    = (0x5231)
                           005232   585  UART1_BRR1  = (0x5232)
                           005233   586  UART1_BRR2  = (0x5233)
                           005234   587  UART1_CR1   = (0x5234)
                           005235   588  UART1_CR2   = (0x5235)
                           005236   589  UART1_CR3   = (0x5236)
                           005237   590  UART1_CR4   = (0x5237)
                           005238   591  UART1_CR5   = (0x5238)
                           005239   592  UART1_GTR   = (0x5239)
                           00523A   593  UART1_PSCR  = (0x523A)
                                    594 
                                    595 ; UART3
                           005240   596  UART3_BASE  = (0x5240)
                           005240   597  UART3_SR    = (0x5240)
                           005241   598  UART3_DR    = (0x5241)
                           005242   599  UART3_BRR1  = (0x5242)
                           005243   600  UART3_BRR2  = (0x5243)
                           005244   601  UART3_CR1   = (0x5244)
                           005245   602  UART3_CR2   = (0x5245)
                           005246   603  UART3_CR3   = (0x5246)
                           005247   604  UART3_CR4   = (0x5247)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 14.
Hexadecimal [24-Bits]



                           004249   605  UART3_CR6   = (0x4249)
                                    606 
                                    607 ; UART Status Register bits
                           000007   608  UART_SR_TXE = (7)
                           000006   609  UART_SR_TC = (6)
                           000005   610  UART_SR_RXNE = (5)
                           000004   611  UART_SR_IDLE = (4)
                           000003   612  UART_SR_OR = (3)
                           000002   613  UART_SR_NF = (2)
                           000001   614  UART_SR_FE = (1)
                           000000   615  UART_SR_PE = (0)
                                    616 
                                    617 ; Uart Control Register bits
                           000007   618  UART_CR1_R8 = (7)
                           000006   619  UART_CR1_T8 = (6)
                           000005   620  UART_CR1_UARTD = (5)
                           000004   621  UART_CR1_M = (4)
                           000003   622  UART_CR1_WAKE = (3)
                           000002   623  UART_CR1_PCEN = (2)
                           000001   624  UART_CR1_PS = (1)
                           000000   625  UART_CR1_PIEN = (0)
                                    626 
                           000007   627  UART_CR2_TIEN = (7)
                           000006   628  UART_CR2_TCIEN = (6)
                           000005   629  UART_CR2_RIEN = (5)
                           000004   630  UART_CR2_ILIEN = (4)
                           000003   631  UART_CR2_TEN = (3)
                           000002   632  UART_CR2_REN = (2)
                           000001   633  UART_CR2_RWU = (1)
                           000000   634  UART_CR2_SBK = (0)
                                    635 
                           000006   636  UART_CR3_LINEN = (6)
                           000005   637  UART_CR3_STOP1 = (5)
                           000004   638  UART_CR3_STOP0 = (4)
                           000003   639  UART_CR3_CLKEN = (3)
                           000002   640  UART_CR3_CPOL = (2)
                           000001   641  UART_CR3_CPHA = (1)
                           000000   642  UART_CR3_LBCL = (0)
                                    643 
                           000006   644  UART_CR4_LBDIEN = (6)
                           000005   645  UART_CR4_LBDL = (5)
                           000004   646  UART_CR4_LBDF = (4)
                           000003   647  UART_CR4_ADD3 = (3)
                           000002   648  UART_CR4_ADD2 = (2)
                           000001   649  UART_CR4_ADD1 = (1)
                           000000   650  UART_CR4_ADD0 = (0)
                                    651 
                           000005   652  UART_CR5_SCEN = (5)
                           000004   653  UART_CR5_NACK = (4)
                           000003   654  UART_CR5_HDSEL = (3)
                           000002   655  UART_CR5_IRLP = (2)
                           000001   656  UART_CR5_IREN = (1)
                                    657 ; LIN mode config register
                           000007   658  UART_CR6_LDUM = (7)
                           000005   659  UART_CR6_LSLV = (5)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 15.
Hexadecimal [24-Bits]



                           000004   660  UART_CR6_LASE = (4)
                           000002   661  UART_CR6_LHDIEN = (2) 
                           000001   662  UART_CR6_LHDF = (1)
                           000000   663  UART_CR6_LSF = (0)
                                    664 
                                    665 ; TIMERS
                                    666 ; Timer 1 - 16-bit timer with complementary PWM outputs
                           005250   667  TIM1_CR1  = (0x5250)
                           005251   668  TIM1_CR2  = (0x5251)
                           005252   669  TIM1_SMCR  = (0x5252)
                           005253   670  TIM1_ETR  = (0x5253)
                           005254   671  TIM1_IER  = (0x5254)
                           005255   672  TIM1_SR1  = (0x5255)
                           005256   673  TIM1_SR2  = (0x5256)
                           005257   674  TIM1_EGR  = (0x5257)
                           005258   675  TIM1_CCMR1  = (0x5258)
                           005259   676  TIM1_CCMR2  = (0x5259)
                           00525A   677  TIM1_CCMR3  = (0x525A)
                           00525B   678  TIM1_CCMR4  = (0x525B)
                           00525C   679  TIM1_CCER1  = (0x525C)
                           00525D   680  TIM1_CCER2  = (0x525D)
                           00525E   681  TIM1_CNTRH  = (0x525E)
                           00525F   682  TIM1_CNTRL  = (0x525F)
                           005260   683  TIM1_PSCRH  = (0x5260)
                           005261   684  TIM1_PSCRL  = (0x5261)
                           005262   685  TIM1_ARRH  = (0x5262)
                           005263   686  TIM1_ARRL  = (0x5263)
                           005264   687  TIM1_RCR  = (0x5264)
                           005265   688  TIM1_CCR1H  = (0x5265)
                           005266   689  TIM1_CCR1L  = (0x5266)
                           005267   690  TIM1_CCR2H  = (0x5267)
                           005268   691  TIM1_CCR2L  = (0x5268)
                           005269   692  TIM1_CCR3H  = (0x5269)
                           00526A   693  TIM1_CCR3L  = (0x526A)
                           00526B   694  TIM1_CCR4H  = (0x526B)
                           00526C   695  TIM1_CCR4L  = (0x526C)
                           00526D   696  TIM1_BKR  = (0x526D)
                           00526E   697  TIM1_DTR  = (0x526E)
                           00526F   698  TIM1_OISR  = (0x526F)
                                    699 
                                    700 ; Timer Control Register bits
                           000007   701  TIM_CR1_ARPE = (7)
                           000006   702  TIM_CR1_CMSH = (6)
                           000005   703  TIM_CR1_CMSL = (5)
                           000004   704  TIM_CR1_DIR = (4)
                           000003   705  TIM_CR1_OPM = (3)
                           000002   706  TIM_CR1_URS = (2)
                           000001   707  TIM_CR1_UDIS = (1)
                           000000   708  TIM_CR1_CEN = (0)
                                    709 
                           000006   710  TIM1_CR2_MMS2 = (6)
                           000005   711  TIM1_CR2_MMS1 = (5)
                           000004   712  TIM1_CR2_MMS0 = (4)
                           000002   713  TIM1_CR2_COMS = (2)
                           000000   714  TIM1_CR2_CCPC = (0)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 16.
Hexadecimal [24-Bits]



                                    715 
                                    716 ; Timer Slave Mode Control bits
                           000007   717  TIM1_SMCR_MSM = (7)
                           000006   718  TIM1_SMCR_TS2 = (6)
                           000005   719  TIM1_SMCR_TS1 = (5)
                           000004   720  TIM1_SMCR_TS0 = (4)
                           000002   721  TIM1_SMCR_SMS2 = (2)
                           000001   722  TIM1_SMCR_SMS1 = (1)
                           000000   723  TIM1_SMCR_SMS0 = (0)
                                    724 
                                    725 ; Timer External Trigger Enable bits
                           000007   726  TIM1_ETR_ETP = (7)
                           000006   727  TIM1_ETR_ECE = (6)
                           000005   728  TIM1_ETR_ETPS1 = (5)
                           000004   729  TIM1_ETR_ETPS0 = (4)
                           000003   730  TIM1_ETR_ETF3 = (3)
                           000002   731  TIM1_ETR_ETF2 = (2)
                           000001   732  TIM1_ETR_ETF1 = (1)
                           000000   733  TIM1_ETR_ETF0 = (0)
                                    734 
                                    735 ; Timer Interrupt Enable bits
                           000007   736  TIM1_IER_BIE = (7)
                           000006   737  TIM1_IER_TIE = (6)
                           000005   738  TIM1_IER_COMIE = (5)
                           000004   739  TIM1_IER_CC4IE = (4)
                           000003   740  TIM1_IER_CC3IE = (3)
                           000002   741  TIM1_IER_CC2IE = (2)
                           000001   742  TIM1_IER_CC1IE = (1)
                           000000   743  TIM1_IER_UIE = (0)
                                    744 
                                    745 ; Timer Status Register bits
                           000007   746  TIM1_SR1_BIF = (7)
                           000006   747  TIM1_SR1_TIF = (6)
                           000005   748  TIM1_SR1_COMIF = (5)
                           000004   749  TIM1_SR1_CC4IF = (4)
                           000003   750  TIM1_SR1_CC3IF = (3)
                           000002   751  TIM1_SR1_CC2IF = (2)
                           000001   752  TIM1_SR1_CC1IF = (1)
                           000000   753  TIM1_SR1_UIF = (0)
                                    754 
                           000004   755  TIM1_SR2_CC4OF = (4)
                           000003   756  TIM1_SR2_CC3OF = (3)
                           000002   757  TIM1_SR2_CC2OF = (2)
                           000001   758  TIM1_SR2_CC1OF = (1)
                                    759 
                                    760 ; Timer Event Generation Register bits
                           000007   761  TIM1_EGR_BG = (7)
                           000006   762  TIM1_EGR_TG = (6)
                           000005   763  TIM1_EGR_COMG = (5)
                           000004   764  TIM1_EGR_CC4G = (4)
                           000003   765  TIM1_EGR_CC3G = (3)
                           000002   766  TIM1_EGR_CC2G = (2)
                           000001   767  TIM1_EGR_CC1G = (1)
                           000000   768  TIM1_EGR_UG = (0)
                                    769 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 17.
Hexadecimal [24-Bits]



                                    770 ; Capture/Compare Mode Register 1 - channel configured in output
                           000007   771  TIM1_CCMR1_OC1CE = (7)
                           000006   772  TIM1_CCMR1_OC1M2 = (6)
                           000005   773  TIM1_CCMR1_OC1M1 = (5)
                           000004   774  TIM1_CCMR1_OC1M0 = (4)
                           000003   775  TIM1_CCMR1_OC1PE = (3)
                           000002   776  TIM1_CCMR1_OC1FE = (2)
                           000001   777  TIM1_CCMR1_CC1S1 = (1)
                           000000   778  TIM1_CCMR1_CC1S0 = (0)
                                    779 
                                    780 ; Capture/Compare Mode Register 1 - channel configured in input
                           000007   781  TIM1_CCMR1_IC1F3 = (7)
                           000006   782  TIM1_CCMR1_IC1F2 = (6)
                           000005   783  TIM1_CCMR1_IC1F1 = (5)
                           000004   784  TIM1_CCMR1_IC1F0 = (4)
                           000003   785  TIM1_CCMR1_IC1PSC1 = (3)
                           000002   786  TIM1_CCMR1_IC1PSC0 = (2)
                                    787 ;  TIM1_CCMR1_CC1S1 = (1)
                           000000   788  TIM1_CCMR1_CC1S0 = (0)
                                    789 
                                    790 ; Capture/Compare Mode Register 2 - channel configured in output
                           000007   791  TIM1_CCMR2_OC2CE = (7)
                           000006   792  TIM1_CCMR2_OC2M2 = (6)
                           000005   793  TIM1_CCMR2_OC2M1 = (5)
                           000004   794  TIM1_CCMR2_OC2M0 = (4)
                           000003   795  TIM1_CCMR2_OC2PE = (3)
                           000002   796  TIM1_CCMR2_OC2FE = (2)
                           000001   797  TIM1_CCMR2_CC2S1 = (1)
                           000000   798  TIM1_CCMR2_CC2S0 = (0)
                                    799 
                                    800 ; Capture/Compare Mode Register 2 - channel configured in input
                           000007   801  TIM1_CCMR2_IC2F3 = (7)
                           000006   802  TIM1_CCMR2_IC2F2 = (6)
                           000005   803  TIM1_CCMR2_IC2F1 = (5)
                           000004   804  TIM1_CCMR2_IC2F0 = (4)
                           000003   805  TIM1_CCMR2_IC2PSC1 = (3)
                           000002   806  TIM1_CCMR2_IC2PSC0 = (2)
                                    807 ;  TIM1_CCMR2_CC2S1 = (1)
                           000000   808  TIM1_CCMR2_CC2S0 = (0)
                                    809 
                                    810 ; Capture/Compare Mode Register 3 - channel configured in output
                           000007   811  TIM1_CCMR3_OC3CE = (7)
                           000006   812  TIM1_CCMR3_OC3M2 = (6)
                           000005   813  TIM1_CCMR3_OC3M1 = (5)
                           000004   814  TIM1_CCMR3_OC3M0 = (4)
                           000003   815  TIM1_CCMR3_OC3PE = (3)
                           000002   816  TIM1_CCMR3_OC3FE = (2)
                           000001   817  TIM1_CCMR3_CC3S1 = (1)
                           000000   818  TIM1_CCMR3_CC3S0 = (0)
                                    819 
                                    820 ; Capture/Compare Mode Register 3 - channel configured in input
                           000007   821  TIM1_CCMR3_IC3F3 = (7)
                           000006   822  TIM1_CCMR3_IC3F2 = (6)
                           000005   823  TIM1_CCMR3_IC3F1 = (5)
                           000004   824  TIM1_CCMR3_IC3F0 = (4)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 18.
Hexadecimal [24-Bits]



                           000003   825  TIM1_CCMR3_IC3PSC1 = (3)
                           000002   826  TIM1_CCMR3_IC3PSC0 = (2)
                                    827 ;  TIM1_CCMR3_CC3S1 = (1)
                           000000   828  TIM1_CCMR3_CC3S0 = (0)
                                    829 
                                    830 ; Capture/Compare Mode Register 4 - channel configured in output
                           000007   831  TIM1_CCMR4_OC4CE = (7)
                           000006   832  TIM1_CCMR4_OC4M2 = (6)
                           000005   833  TIM1_CCMR4_OC4M1 = (5)
                           000004   834  TIM1_CCMR4_OC4M0 = (4)
                           000003   835  TIM1_CCMR4_OC4PE = (3)
                           000002   836  TIM1_CCMR4_OC4FE = (2)
                           000001   837  TIM1_CCMR4_CC4S1 = (1)
                           000000   838  TIM1_CCMR4_CC4S0 = (0)
                                    839 
                                    840 ; Capture/Compare Mode Register 4 - channel configured in input
                           000007   841  TIM1_CCMR4_IC4F3 = (7)
                           000006   842  TIM1_CCMR4_IC4F2 = (6)
                           000005   843  TIM1_CCMR4_IC4F1 = (5)
                           000004   844  TIM1_CCMR4_IC4F0 = (4)
                           000003   845  TIM1_CCMR4_IC4PSC1 = (3)
                           000002   846  TIM1_CCMR4_IC4PSC0 = (2)
                                    847 ;  TIM1_CCMR4_CC4S1 = (1)
                           000000   848  TIM1_CCMR4_CC4S0 = (0)
                                    849 
                                    850 ; Timer 2 - 16-bit timer
                           005300   851  TIM2_CR1  = (0x5300)
                           005301   852  TIM2_IER  = (0x5301)
                           005302   853  TIM2_SR1  = (0x5302)
                           005303   854  TIM2_SR2  = (0x5303)
                           005304   855  TIM2_EGR  = (0x5304)
                           005305   856  TIM2_CCMR1  = (0x5305)
                           005306   857  TIM2_CCMR2  = (0x5306)
                           005307   858  TIM2_CCMR3  = (0x5307)
                           005308   859  TIM2_CCER1  = (0x5308)
                           005309   860  TIM2_CCER2  = (0x5309)
                           00530A   861  TIM2_CNTRH  = (0x530A)
                           00530B   862  TIM2_CNTRL  = (0x530B)
                           00530C   863  TIM2_PSCR  = (0x530C)
                           00530D   864  TIM2_ARRH  = (0x530D)
                           00530E   865  TIM2_ARRL  = (0x530E)
                           00530F   866  TIM2_CCR1H  = (0x530F)
                           005310   867  TIM2_CCR1L  = (0x5310)
                           005311   868  TIM2_CCR2H  = (0x5311)
                           005312   869  TIM2_CCR2L  = (0x5312)
                           005313   870  TIM2_CCR3H  = (0x5313)
                           005314   871  TIM2_CCR3L  = (0x5314)
                                    872 
                                    873 ; TIM2_CR1 bitfields
                           000000   874  TIM2_CR1_CEN=(0) ; Counter enable
                           000001   875  TIM2_CR1_UDIS=(1) ; Update disable
                           000002   876  TIM2_CR1_URS=(2) ; Update request source
                           000003   877  TIM2_CR1_OPM=(3) ; One-pulse mode
                           000007   878  TIM2_CR1_ARPE=(7) ; Auto-reload preload enable
                                    879 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 19.
Hexadecimal [24-Bits]



                                    880 ; TIMER2_CCMR bitfields 
                           000000   881  TIM2_CCMR_CCS=(0) ; input/output select
                           000003   882  TIM2_CCMR_OCPE=(3) ; preload enable
                           000004   883  TIM2_CCMR_OCM=(4)  ; output compare mode 
                                    884 
                                    885 ; TIMER2_CCER1 bitfields
                           000000   886  TIM2_CCER1_CC1E=(0)
                           000001   887  TIM2_CCER1_CC1P=(1)
                           000004   888  TIM2_CCER1_CC2E=(4)
                           000005   889  TIM2_CCER1_CC2P=(5)
                                    890 
                                    891 ; TIMER2_EGR bitfields
                           000000   892  TIM2_EGR_UG=(0) ; update generation
                           000001   893  TIM2_EGR_CC1G=(1) ; Capture/compare 1 generation
                           000002   894  TIM2_EGR_CC2G=(2) ; Capture/compare 2 generation
                           000003   895  TIM2_EGR_CC3G=(3) ; Capture/compare 3 generation
                           000006   896  TIM2_EGR_TG=(6); Trigger generation
                                    897 
                                    898 ; Timer 3
                           005320   899  TIM3_CR1  = (0x5320)
                           005321   900  TIM3_IER  = (0x5321)
                           005322   901  TIM3_SR1  = (0x5322)
                           005323   902  TIM3_SR2  = (0x5323)
                           005324   903  TIM3_EGR  = (0x5324)
                           005325   904  TIM3_CCMR1  = (0x5325)
                           005326   905  TIM3_CCMR2  = (0x5326)
                           005327   906  TIM3_CCER1  = (0x5327)
                           005328   907  TIM3_CNTRH  = (0x5328)
                           005329   908  TIM3_CNTRL  = (0x5329)
                           00532A   909  TIM3_PSCR  = (0x532A)
                           00532B   910  TIM3_ARRH  = (0x532B)
                           00532C   911  TIM3_ARRL  = (0x532C)
                           00532D   912  TIM3_CCR1H  = (0x532D)
                           00532E   913  TIM3_CCR1L  = (0x532E)
                           00532F   914  TIM3_CCR2H  = (0x532F)
                           005330   915  TIM3_CCR2L  = (0x5330)
                                    916 
                                    917 ; TIM3_CR1  fields
                           000000   918  TIM3_CR1_CEN = (0)
                           000001   919  TIM3_CR1_UDIS = (1)
                           000002   920  TIM3_CR1_URS = (2)
                           000003   921  TIM3_CR1_OPM = (3)
                           000007   922  TIM3_CR1_ARPE = (7)
                                    923 ; TIM3_CCR2  fields
                           000000   924  TIM3_CCMR2_CC2S_POS = (0)
                           000003   925  TIM3_CCMR2_OC2PE_POS = (3)
                           000004   926  TIM3_CCMR2_OC2M_POS = (4)  
                                    927 ; TIM3_CCER1 fields
                           000000   928  TIM3_CCER1_CC1E = (0)
                           000001   929  TIM3_CCER1_CC1P = (1)
                           000004   930  TIM3_CCER1_CC2E = (4)
                           000005   931  TIM3_CCER1_CC2P = (5)
                                    932 ; TIM3_CCER2 fields
                           000000   933  TIM3_CCER2_CC3E = (0)
                           000001   934  TIM3_CCER2_CC3P = (1)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 20.
Hexadecimal [24-Bits]



                                    935 
                                    936 ; Timer 4
                           005340   937  TIM4_CR1  = (0x5340)
                           005341   938  TIM4_IER  = (0x5341)
                           005342   939  TIM4_SR  = (0x5342)
                           005343   940  TIM4_EGR  = (0x5343)
                           005344   941  TIM4_CNTR  = (0x5344)
                           005345   942  TIM4_PSCR  = (0x5345)
                           005346   943  TIM4_ARR  = (0x5346)
                                    944 
                                    945 ; Timer 4 bitmasks
                                    946 
                           000007   947  TIM4_CR1_ARPE = (7)
                           000003   948  TIM4_CR1_OPM = (3)
                           000002   949  TIM4_CR1_URS = (2)
                           000001   950  TIM4_CR1_UDIS = (1)
                           000000   951  TIM4_CR1_CEN = (0)
                                    952 
                           000000   953  TIM4_IER_UIE = (0)
                                    954 
                           000000   955  TIM4_SR_UIF = (0)
                                    956 
                           000000   957  TIM4_EGR_UG = (0)
                                    958 
                           000002   959  TIM4_PSCR_PSC2 = (2)
                           000001   960  TIM4_PSCR_PSC1 = (1)
                           000000   961  TIM4_PSCR_PSC0 = (0)
                                    962 
                           000000   963  TIM4_PSCR_1 = 0
                           000001   964  TIM4_PSCR_2 = 1
                           000002   965  TIM4_PSCR_4 = 2
                           000003   966  TIM4_PSCR_8 = 3
                           000004   967  TIM4_PSCR_16 = 4
                           000005   968  TIM4_PSCR_32 = 5
                           000006   969  TIM4_PSCR_64 = 6
                           000007   970  TIM4_PSCR_128 = 7
                                    971 
                                    972 ; ADC2
                           005400   973  ADC_CSR  = (0x5400)
                           005401   974  ADC_CR1  = (0x5401)
                           005402   975  ADC_CR2  = (0x5402)
                           005403   976  ADC_CR3  = (0x5403)
                           005404   977  ADC_DRH  = (0x5404)
                           005405   978  ADC_DRL  = (0x5405)
                           005406   979  ADC_TDRH  = (0x5406)
                           005407   980  ADC_TDRL  = (0x5407)
                                    981  
                                    982 ; ADC bitmasks
                                    983 
                           000007   984  ADC_CSR_EOC = (7)
                           000006   985  ADC_CSR_AWD = (6)
                           000005   986  ADC_CSR_EOCIE = (5)
                           000004   987  ADC_CSR_AWDIE = (4)
                           000003   988  ADC_CSR_CH3 = (3)
                           000002   989  ADC_CSR_CH2 = (2)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 21.
Hexadecimal [24-Bits]



                           000001   990  ADC_CSR_CH1 = (1)
                           000000   991  ADC_CSR_CH0 = (0)
                                    992 
                           000006   993  ADC_CR1_SPSEL2 = (6)
                           000005   994  ADC_CR1_SPSEL1 = (5)
                           000004   995  ADC_CR1_SPSEL0 = (4)
                           000001   996  ADC_CR1_CONT = (1)
                           000000   997  ADC_CR1_ADON = (0)
                                    998 
                           000006   999  ADC_CR2_EXTTRIG = (6)
                           000005  1000  ADC_CR2_EXTSEL1 = (5)
                           000004  1001  ADC_CR2_EXTSEL0 = (4)
                           000003  1002  ADC_CR2_ALIGN = (3)
                           000001  1003  ADC_CR2_SCAN = (1)
                                   1004 
                           000007  1005  ADC_CR3_DBUF = (7)
                           000006  1006  ADC_CR3_DRH = (6)
                                   1007 
                                   1008 ; beCAN
                           005420  1009  CAN_MCR = (0x5420)
                           005421  1010  CAN_MSR = (0x5421)
                           005422  1011  CAN_TSR = (0x5422)
                           005423  1012  CAN_TPR = (0x5423)
                           005424  1013  CAN_RFR = (0x5424)
                           005425  1014  CAN_IER = (0x5425)
                           005426  1015  CAN_DGR = (0x5426)
                           005427  1016  CAN_FPSR = (0x5427)
                           005428  1017  CAN_P0 = (0x5428)
                           005429  1018  CAN_P1 = (0x5429)
                           00542A  1019  CAN_P2 = (0x542A)
                           00542B  1020  CAN_P3 = (0x542B)
                           00542C  1021  CAN_P4 = (0x542C)
                           00542D  1022  CAN_P5 = (0x542D)
                           00542E  1023  CAN_P6 = (0x542E)
                           00542F  1024  CAN_P7 = (0x542F)
                           005430  1025  CAN_P8 = (0x5430)
                           005431  1026  CAN_P9 = (0x5431)
                           005432  1027  CAN_PA = (0x5432)
                           005433  1028  CAN_PB = (0x5433)
                           005434  1029  CAN_PC = (0x5434)
                           005435  1030  CAN_PD = (0x5435)
                           005436  1031  CAN_PE = (0x5436)
                           005437  1032  CAN_PF = (0x5437)
                                   1033 
                                   1034 
                                   1035 ; CPU
                           007F00  1036  CPU_A  = (0x7F00)
                           007F01  1037  CPU_PCE  = (0x7F01)
                           007F02  1038  CPU_PCH  = (0x7F02)
                           007F03  1039  CPU_PCL  = (0x7F03)
                           007F04  1040  CPU_XH  = (0x7F04)
                           007F05  1041  CPU_XL  = (0x7F05)
                           007F06  1042  CPU_YH  = (0x7F06)
                           007F07  1043  CPU_YL  = (0x7F07)
                           007F08  1044  CPU_SPH  = (0x7F08)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 22.
Hexadecimal [24-Bits]



                           007F09  1045  CPU_SPL   = (0x7F09)
                           007F0A  1046  CPU_CCR   = (0x7F0A)
                                   1047 
                                   1048 ; global configuration register
                           007F60  1049  CFG_GCR   = (0x7F60)
                           000001  1050  CFG_GCR_AL = 1
                           000000  1051  CFG_GCR_SWIM = 0
                                   1052 
                                   1053 ; interrupt software priority 
                           007F70  1054  ITC_SPR1   = (0x7F70) ; (0..3) 0->resreved,AWU..EXT0 
                           007F71  1055  ITC_SPR2   = (0x7F71) ; (4..7) EXT1..EXT4 RX 
                           007F72  1056  ITC_SPR3   = (0x7F72) ; (8..11) beCAN RX..TIM1 UPDT/OVR  
                           007F73  1057  ITC_SPR4   = (0x7F73) ; (12..15) TIM1 CAP/CMP .. TIM3 UPDT/OVR 
                           007F74  1058  ITC_SPR5   = (0x7F74) ; (16..19) TIM3 CAP/CMP..I2C  
                           007F75  1059  ITC_SPR6   = (0x7F75) ; (20..23) UART3 TX..TIM4 CAP/OVR 
                           007F76  1060  ITC_SPR7   = (0x7F76) ; (24..29) FLASH WR..
                           007F77  1061  ITC_SPR8   = (0x7F77) ; (30..32) ..
                                   1062 
                           000001  1063 ITC_SPR_LEVEL1=1 
                           000000  1064 ITC_SPR_LEVEL2=0
                           000003  1065 ITC_SPR_LEVEL3=3 
                                   1066 
                                   1067 ; SWIM, control and status register
                           007F80  1068  SWIM_CSR   = (0x7F80)
                                   1069 ; debug registers
                           007F90  1070  DM_BK1RE   = (0x7F90)
                           007F91  1071  DM_BK1RH   = (0x7F91)
                           007F92  1072  DM_BK1RL   = (0x7F92)
                           007F93  1073  DM_BK2RE   = (0x7F93)
                           007F94  1074  DM_BK2RH   = (0x7F94)
                           007F95  1075  DM_BK2RL   = (0x7F95)
                           007F96  1076  DM_CR1   = (0x7F96)
                           007F97  1077  DM_CR2   = (0x7F97)
                           007F98  1078  DM_CSR1   = (0x7F98)
                           007F99  1079  DM_CSR2   = (0x7F99)
                           007F9A  1080  DM_ENFCTR   = (0x7F9A)
                                   1081 
                                   1082 ; Interrupt Numbers
                           000000  1083  INT_TLI = 0
                           000001  1084  INT_AWU = 1
                           000002  1085  INT_CLK = 2
                           000003  1086  INT_EXTI0 = 3
                           000004  1087  INT_EXTI1 = 4
                           000005  1088  INT_EXTI2 = 5
                           000006  1089  INT_EXTI3 = 6
                           000007  1090  INT_EXTI4 = 7
                           000008  1091  INT_CAN_RX = 8
                           000009  1092  INT_CAN_TX = 9
                           00000A  1093  INT_SPI = 10
                           00000B  1094  INT_TIM1_OVF = 11
                           00000C  1095  INT_TIM1_CCM = 12
                           00000D  1096  INT_TIM2_OVF = 13
                           00000E  1097  INT_TIM2_CCM = 14
                           00000F  1098  INT_TIM3_OVF = 15
                           000010  1099  INT_TIM3_CCM = 16
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 23.
Hexadecimal [24-Bits]



                           000011  1100  INT_UART1_TX_COMPLETED = 17
                           000012  1101  INT_AUART1_RX_FULL = 18
                           000013  1102  INT_I2C = 19
                           000014  1103  INT_UART3_TX_COMPLETED = 20
                           000015  1104  INT_UART3_RX_FULL = 21
                           000016  1105  INT_ADC2 = 22
                           000017  1106  INT_TIM4_OVF = 23
                           000018  1107  INT_FLASH = 24
                                   1108 
                                   1109 ; Interrupt Vectors
                           008000  1110  INT_VECTOR_RESET = 0x8000
                           008004  1111  INT_VECTOR_TRAP = 0x8004
                           008008  1112  INT_VECTOR_TLI = 0x8008
                           00800C  1113  INT_VECTOR_AWU = 0x800C
                           008010  1114  INT_VECTOR_CLK = 0x8010
                           008014  1115  INT_VECTOR_EXTI0 = 0x8014
                           008018  1116  INT_VECTOR_EXTI1 = 0x8018
                           00801C  1117  INT_VECTOR_EXTI2 = 0x801C
                           008020  1118  INT_VECTOR_EXTI3 = 0x8020
                           008024  1119  INT_VECTOR_EXTI4 = 0x8024
                           008028  1120  INT_VECTOR_CAN_RX = 0x8028
                           00802C  1121  INT_VECTOR_CAN_TX = 0x802c
                           008030  1122  INT_VECTOR_SPI = 0x8030
                           008034  1123  INT_VECTOR_TIM1_OVF = 0x8034
                           008038  1124  INT_VECTOR_TIM1_CCM = 0x8038
                           00803C  1125  INT_VECTOR_TIM2_OVF = 0x803C
                           008040  1126  INT_VECTOR_TIM2_CCM = 0x8040
                           008044  1127  INT_VECTOR_TIM3_OVF = 0x8044
                           008048  1128  INT_VECTOR_TIM3_CCM = 0x8048
                           00804C  1129  INT_VECTOR_UART1_TX_COMPLETED = 0x804c
                           008050  1130  INT_VECTOR_UART1_RX_FULL = 0x8050
                           008054  1131  INT_VECTOR_I2C = 0x8054
                           008058  1132  INT_VECTOR_UART3_TX_COMPLETED = 0x8058
                           00805C  1133  INT_VECTOR_UART3_RX_FULL = 0x805C
                           008060  1134  INT_VECTOR_ADC2 = 0x8060
                           008064  1135  INT_VECTOR_TIM4_OVF = 0x8064
                           008068  1136  INT_VECTOR_FLASH = 0x8068
                                   1137 
                                   1138 ; Condition code register bits
                           000007  1139 CC_V = 7  ; overflow flag 
                           000005  1140 CC_I1= 5  ; interrupt bit 1
                           000004  1141 CC_H = 4  ; half carry 
                           000003  1142 CC_I0 = 3 ; interrupt bit 0
                           000002  1143 CC_N = 2 ;  negative flag 
                           000001  1144 CC_Z = 1 ;  zero flag  
                           000000  1145 CC_C = 0 ; carry bit 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 24.
Hexadecimal [24-Bits]



                                     12     .include "inc/nucleo_8s208.inc"
                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2019 
                                      3 ; This file is part of MONA 
                                      4 ;
                                      5 ;     MONA is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     MONA is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with MONA.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     19 ; NUCLEO-8S208RB board specific definitions
                                     20 ; Date: 2019/10/29
                                     21 ; author: Jacques Deschênes, copyright 2018,2019
                                     22 ; licence: GPLv3
                                     23 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     24 
                                     25 ; mcu on board is stm8s208rbt6
                                     26 
                                     27 ; crystal on board is 8Mhz
                           7A1200    28 FHSE = 8000000
                                     29 
                                     30 ; LED2 is user LED
                                     31 ; connected to PC5 via Q2 -> 2N7002 MOSFET
                           00500A    32 LED_PORT = PC_BASE ;port C  ODR
                           000005    33 LED_BIT = 5
                           000020    34 LED_MASK = (1<<LED_BIT) ;bit 5 mask
                                     35 
                                     36      
                                     37 ;  user interface UART via ST-LINK , (T-VCP)
                                     38 
                           000000    39 UART=UART1
                                     40 ; port used by  UART1  
                           005000    41 UART_PORT_ODR=PA_ODR 
                           005002    42 UART_PORT_DDR=PA_DDR 
                           005001    43 UART_PORT_IDR=PA_IDR 
                           005003    44 UART_PORT_CR1=PA_CR1 
                           005004    45 UART_PORT_CR2=PA_CR2 
                                     46 
                                     47 ; clock enable bit 
                           000002    48 UART_PCKEN=CLK_PCKENR1_UART1
                                     49 
                                     50 ; UART1 registers 
                           005230    51 UART_SR=UART1_SR
                           005231    52 UART_DR=UART1_DR
                           005232    53 UART_BRR1=UART1_BRR1
                           005233    54 UART_BRR2=UART1_BRR2
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 25.
Hexadecimal [24-Bits]



                           005234    55 UART_CR1=UART1_CR1
                           005235    56 UART_CR2=UART1_CR2
                                     57 
                                     58 ; TX, RX pin
                           000005    59 UART_TX_PIN=UART1_TX_PIN
                           000004    60 UART_RX_PIN=UART1_RX_PIN 
                                     61 
                                     62 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 26.
Hexadecimal [24-Bits]



                                     13     .include "inc/ascii.inc"
                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2019 
                                      3 ; This file is part of MONA 
                                      4 ;
                                      5 ;     MONA is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     MONA is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with MONA.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 
                                     19 ;-------------------------------------------------------
                                     20 ;     ASCII control  values
                                     21 ;     CTRL_x   are VT100 keyboard values  
                                     22 ; REF: https://en.wikipedia.org/wiki/ASCII    
                                     23 ;-------------------------------------------------------
                           000001    24 		CTRL_A = 1
                           000001    25 		SOH=CTRL_A  ; start of heading 
                           000002    26 		CTRL_B = 2
                           000002    27 		STX=CTRL_B  ; start of text 
                           000003    28 		CTRL_C = 3
                           000003    29 		ETX=CTRL_C  ; end of text 
                           000004    30 		CTRL_D = 4
                           000004    31 		EOT=CTRL_D  ; end of transmission 
                           000005    32 		CTRL_E = 5
                           000005    33 		ENQ=CTRL_E  ; enquery 
                           000006    34 		CTRL_F = 6
                           000006    35 		ACK=CTRL_F  ; acknowledge
                           000007    36 		CTRL_G = 7
                           000007    37         BELL = 7    ; vt100 terminal generate a sound.
                           000008    38 		CTRL_H = 8  
                           000008    39 		BS = 8     ; back space 
                           000009    40         CTRL_I = 9
                           000009    41     	TAB = 9     ; horizontal tabulation
                           00000A    42         CTRL_J = 10 
                           00000A    43 		LF = 10     ; line feed
                           00000B    44 		CTRL_K = 11
                           00000B    45         VT = 11     ; vertical tabulation 
                           00000C    46 		CTRL_L = 12
                           00000C    47         FF = 12      ; new page
                           00000D    48 		CTRL_M = 13
                           00000D    49 		CR = 13      ; carriage return 
                           00000E    50 		CTRL_N = 14
                           00000E    51 		SO=CTRL_N    ; shift out 
                           00000F    52 		CTRL_O = 15
                           00000F    53 		SI=CTRL_O    ; shift in 
                           000010    54 		CTRL_P = 16
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 27.
Hexadecimal [24-Bits]



                           000010    55 		DLE=CTRL_P   ; data link escape 
                           000011    56 		CTRL_Q = 17
                           000011    57 		DC1=CTRL_Q   ; device control 1 
                           000011    58 		XON=DC1 
                           000012    59 		CTRL_R = 18
                           000012    60 		DC2=CTRL_R   ; device control 2 
                           000013    61 		CTRL_S = 19
                           000013    62 		DC3=CTRL_S   ; device control 3
                           000013    63 		XOFF=DC3 
                           000014    64 		CTRL_T = 20
                           000014    65 		DC4=CTRL_T   ; device control 4 
                           000015    66 		CTRL_U = 21
                           000015    67 		NAK=CTRL_U   ; negative acknowledge
                           000016    68 		CTRL_V = 22
                           000016    69 		SYN=CTRL_V   ; synchronous idle 
                           000017    70 		CTRL_W = 23
                           000017    71 		ETB=CTRL_W   ; end of transmission block
                           000018    72 		CTRL_X = 24
                           000018    73 		CAN=CTRL_X   ; cancel 
                           000019    74 		CTRL_Y = 25
                           000019    75 		EM=CTRL_Y    ; end of medium
                           00001A    76 		CTRL_Z = 26
                           00001A    77 		SUB=CTRL_Z   ; substitute 
                           00001A    78 		EOF=SUB      ; end of text file in MSDOS 
                           00001B    79 		ESC = 27     ; escape 
                           00001C    80 		FS=28        ; file separator 
                           00001D    81 		GS=29        ; group separator 
                           00001E    82 		RS=30		 ; record separator 
                           00001F    83 		US=31 		 ; unit separator 
                           000020    84 		SPACE = 32
                           00002C    85 		COMMA = 44
                           00003A    86 		COLON = 58 
                           00003B    87 		SEMIC = 59  
                           000023    88 		SHARP = 35
                           000027    89 		TICK = 39
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 28.
Hexadecimal [24-Bits]



                                     14 	.include "inc/gen_macros.inc" 
                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2019 
                                      3 ; This file is part of STM8_NUCLEO 
                                      4 ;
                                      5 ;     STM8_NUCLEO is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     STM8_NUCLEO is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with STM8_NUCLEO.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 ;--------------------------------------
                                     19 ;   console Input/Output module
                                     20 ;   DATE: 2019-12-11
                                     21 ;    
                                     22 ;   General usage macros.   
                                     23 ;
                                     24 ;--------------------------------------
                                     25 
                                     26     ; reserve space on stack
                                     27     ; for local variables
                                     28     .macro _vars n 
                                     29     sub sp,#n 
                                     30     .endm 
                                     31     
                                     32     ; free space on stack
                                     33     .macro _drop n 
                                     34     addw sp,#n 
                                     35     .endm
                                     36 
                                     37     ; declare ARG_OFS for arguments 
                                     38     ; displacement on stack. This 
                                     39     ; value depend on local variables 
                                     40     ; size.
                                     41     .macro _argofs n 
                                     42     ARG_OFS=2+n 
                                     43     .endm 
                                     44 
                                     45     ; declare a function argument 
                                     46     ; position relative to stack pointer 
                                     47     ; _argofs must be called before it.
                                     48     .macro _arg name ofs 
                                     49     name=ARG_OFS+ofs 
                                     50     .endm 
                                     51 
                                     52     ; software reset 
                                     53     .macro _swreset
                                     54     mov WWDG_CR,#0X80
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 29.
Hexadecimal [24-Bits]



                                     55     .endm 
                                     56 
                                     57     ; increment zero page variable 
                                     58     .macro _incz v 
                                     59     .byte 0x3c, v 
                                     60     .endm 
                                     61 
                                     62     ; decrement zero page variable 
                                     63     .macro _decz v 
                                     64     .byte 0x3a,v 
                                     65     .endm 
                                     66 
                                     67     ; clear zero page variable 
                                     68     .macro _clrz v 
                                     69     .byte 0x3f, v 
                                     70     .endm 
                                     71 
                                     72     ; load A zero page variable 
                                     73     .macro _ldaz v 
                                     74     .byte 0xb6,v 
                                     75     .endm 
                                     76 
                                     77     ; store A zero page variable 
                                     78     .macro _straz v 
                                     79     .byte 0xb7,v 
                                     80     .endm 
                                     81 
                                     82     ; load x from variable in zero page 
                                     83     .macro _ldxz v 
                                     84     .byte 0xbe,v 
                                     85     .endm 
                                     86 
                                     87     ; load y from variable in zero page 
                                     88     .macro _ldyz v 
                                     89     .byte 0x90,0xbe,v 
                                     90     .endm 
                                     91 
                                     92     ; store x in zero page variable 
                                     93     .macro _strxz v 
                                     94     .byte 0xbf,v 
                                     95     .endm 
                                     96 
                                     97     ; store y in zero page variable 
                                     98     .macro _stryz v 
                                     99     .byte 0x90,0xbf,v 
                                    100     .endm 
                                    101 
                                    102     ;  increment 16 bits variable
                                    103     ;  use 10 bytes  
                                    104     .macro _incwz  v 
                                    105         _incz v+1   ; 1 cy, 2 bytes 
                                    106         jrne .+4  ; 1|2 cy, 2 bytes 
                                    107         _incz v     ; 1 cy, 2 bytes  
                                    108     .endm ; 3 cy 
                                    109 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 30.
Hexadecimal [24-Bits]



                                    110     ; xor op with zero page variable 
                                    111     .macro _xorz v 
                                    112     .byte 0xb8,v 
                                    113     .endm 
                                    114     
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 31.
Hexadecimal [24-Bits]



                                     15     .include "inc/app_macros.inc"
                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2025
                                      3 ; This file is part of eeProg 
                                      4 ;
                                      5 ;     eeProg is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     eeProg is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with eeProg.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 ;--------------------------------------
                           0017FF    19 	STACK_EMPTY=RAM_SIZE-1  
                           000080    20     STACK_SIZE=128 
                           000040    21     PAD_SIZE=64
                           000080    22     TIB_SIZE=128 ; input buffer size 
                           000020    23     RX_QUEUE_SIZE==32 ; UART receive queue size 
                                     24 
                           00F424    25     TIM2_CLK_FREQ=62500
                                     26 
                                     27 ;--------------------------------------
                                     28 ;   flags 
                                     29 ;-------------------------------------
                                     30 
                           000000    31     FUPPER=0 
                           000001    32     FTIMER=1
                                     33     
                                     34 ;------------------------------------
                                     35 ;  board user LED control macros 
                                     36 ;------------------------------------
                                     37 
                                     38     .macro _led_on 
                                     39         bset LED_PORT,#LED_BIT 
                                     40     .endm 
                                     41 
                                     42     .macro _led_off 
                                     43         bres LED_PORT,#LED_BIT 
                                     44     .endm 
                                     45 
                                     46     .macro _led_toggle 
                                     47         bcpl LED_PORT,#LED_BIT 
                                     48     .endm 
                                     49 
                                     50 
                                     51    
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 32.
Hexadecimal [24-Bits]



                                     16 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 33.
Hexadecimal [24-Bits]



                                     31 
                                     32   
                                     33 ;;-----------------------------------
                                     34     .area SSEG (ABS)
                                     35 ;; working buffers and stack at end of RAM. 	
                                     36 ;;-----------------------------------
      0016C0                         37     .org RAM_SIZE-STACK_SIZE-TIB_SIZE-PAD_SIZE 
      0016C0                         38 tib: .ds TIB_SIZE ; input buffer 
      001740                         39 write_buffer::                 ; use to write FLASH block (alias for pad )
      001740                         40 pad:: .ds PAD_SIZE             ; working buffer
      001780                         41 stack_full:: .ds STACK_SIZE   ; control stack 
      001800                         42 stack_unf: ; stack underflow ; control_stack bottom 
                                     43 
                                     44 ;;--------------------------------------
                                     45     .area HOME 
                                     46 ;; interrupt vector table at 0x8000
                                     47 ;;--------------------------------------
                                     48 
      000000 82 00 00 4D             49     int cold_start			; RESET vector 
      000004 82 00 00 00             50 	int NonHandledInterrupt ; trap instruction 
      000008 82 00 00 00             51 	int NonHandledInterrupt ;int0 TLI   external top level interrupt
      00000C 82 00 00 00             52 	int NonHandledInterrupt ;int1 AWU   auto wake up from halt
      000010 82 00 00 00             53 	int NonHandledInterrupt ;int2 CLK   clock controller
      000014 82 00 00 00             54 	int NonHandledInterrupt ;int3 EXTI0 gpio A external interrupts
      000018 82 00 00 00             55 	int NonHandledInterrupt ;int4 EXTI1 gpio B external interrupts
      00001C 82 00 00 00             56 	int NonHandledInterrupt ;int5 EXTI2 gpio C external interrupts
      000020 82 00 00 00             57 	int NonHandledInterrupt ;int6 EXTI3 gpio D external interrupts
      000024 82 00 00 00             58 	int NonHandledInterrupt
      000028 82 00 00 00             59 	int NonHandledInterrupt ;int8 beCAN RX interrupt
      00002C 82 00 00 00             60 	int NonHandledInterrupt ;int9 beCAN TX/ER/SC interrupt
      000030 82 00 00 00             61 	int NonHandledInterrupt ;int10 SPI End of transfer
      000034 82 00 00 00             62 	int NonHandledInterrupt ;int11 TIM1 update/overflow/underflow/trigger/break
      000038 82 00 00 00             63 	int NonHandledInterrupt ; int12 TIM1 capture/compare
      00003C 82 00 00 00             64 	int NonHandledInterrupt ;int13 TIM2 update /overflow
      000040 82 00 00 00             65 	int NonHandledInterrupt ;int14 TIM2 capture/compare
      000044 82 00 00 00             66 	int NonHandledInterrupt ;int15 TIM3 Update/overflow
      000048 82 00 00 00             67 	int NonHandledInterrupt ;int16 TIM3 Capture/compare
      00004C 82 00 00 00             68 	int NonHandledInterrupt ;int17 UART1 TX completed
      000050 82 00 00 8F             69 	int UartRxHandler		;int18 UART1 RX full 
      000054 82 00 00 00             70 	int NonHandledInterrupt ;int19 I2C 
      000058 82 00 00 00             71 	int NonHandledInterrupt ;int20 UART3 TX completed
      00005C 82 00 00 00             72 	int NonHandledInterrupt ;int21 UART3 RX full
      000060 82 00 00 00             73 	int NonHandledInterrupt ;int22 ADC2 end of conversion
      000064 82 00 00 04             74 	int Timer4UpdateHandler	;int23 TIM4 update/overflow ; used as msec ticks counter
      000068 82 00 00 00             75 	int NonHandledInterrupt ;int24 flash writing EOP/WR_PG_DIS
      00006C 82 00 00 00             76 	int NonHandledInterrupt ;int25  not used
      000070 82 00 00 00             77 	int NonHandledInterrupt ;int26  not used
      000074 82 00 00 00             78 	int NonHandledInterrupt ;int27  not used
      000078 82 00 00 00             79 	int NonHandledInterrupt ;int28  not used
      00007C 82 00 00 00             80 	int NonHandledInterrupt ;int29  not used
                                     81 
                                     82 
                                     83 ;--------------------------------------
                                     84     .area DATA (ABS)
      000000                         85 	.org 0 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 34.
Hexadecimal [24-Bits]



                                     86 ;--------------------------------------	
                                     87 
                                     88 ; keep the following 3 variables in this order 
      000000                         89 base::  .blkb 1 ; nemeric base used to print integer 
      000001                         90 fmstr:: .blkb 1 ; frequency in Mhz of Fmaster
      000002                         91 timer:: .blkw 1 ;  milliseconds count down timer 
      000004                         92 farptr: .blkb 1 ; 24 bits pointer used by file system, upper-byte
      000005                         93 ptr16::  .blkb 1 ; 16 bits pointer , farptr high-byte 
      000006                         94 ptr8:   .blkb 1 ; 8 bits pointer, farptr low-byte  
      000007                         95 flags:: .blkb 1 ; various boolean flags
      000008                         96 rx1_head::  .blkb 1 ; rx1_queue head pointer
      000009                         97 rx1_tail::   .blkb 1 ; rx1_queue tail pointer  
      00000A                         98 rx1_queue:: .ds RX_QUEUE_SIZE ; UART receive circular queue 
      00002A                         99 mode: .blkb 1 ; command mode 
      00002B                        100 xamadr: .blkw 1 ; examine address 
      00002D                        101 storadr: .blkw 1 ; store address 
      00002F                        102 last: .blkw 1   ; last address parsed from input 
                                    103 
                                    104 	.area CODE 
                                    105 
                                    106 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                    107 ; non handled interrupt 
                                    108 ; reset MCU
                                    109 ;;;;;;;;;;;;;;;;;;;;;;;;;;;
      000000                        110 NonHandledInterrupt:
      000000                        111 	_swreset ; see "inc/gen_macros.inc"
      000000 35 80 50 D1      [ 1]    1     mov WWDG_CR,#0X80
                                    112 
                                    113 
                                    114 ;------------------------------
                                    115 ; TIMER 4 is used to maintain 
                                    116 ; a milliseconds 'ticks' counter
                                    117 ; and decrement 'timer' varaiable
                                    118 ; ticks range {0..2^16-1}
                                    119 ; timer range {0..65535}
                                    120 ;--------------------------------
      000004                        121 Timer4UpdateHandler:
      000004 72 5F 53 42      [ 1]  122 	clr TIM4_SR 
      000008 72 03 00 07 0B   [ 2]  123 	btjf flags,#FTIMER,1$ 
      00000D                        124 	_ldxz timer
      00000D BE 02                    1     .byte 0xbe,timer 
      00000F 5A               [ 2]  125 	decw x 
      000010                        126 	_strxz timer 
      000010 BF 02                    1     .byte 0xbf,timer 
      000012 26 04            [ 1]  127 	jrne 1$ 
      000014 72 13 00 07      [ 1]  128 	bres flags,#FTIMER  
      000018                        129 1$:	
      000018 80               [11]  130 	iret 
                                    131 
                                    132 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                    133 ;    peripherals initialization
                                    134 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                    135 
                                    136 
                                    137 ;---------------------------------
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 35.
Hexadecimal [24-Bits]



                                    138 ; TIM4 is configured to generate an 
                                    139 ; interrupt every millisecond 
                                    140 ;----------------------------------
      000019                        141 timer4_init:
      000019 72 18 50 C7      [ 1]  142 	bset CLK_PCKENR1,#CLK_PCKENR1_TIM4
      00001D 72 11 53 40      [ 1]  143 	bres TIM4_CR1,#TIM4_CR1_CEN 
      000021 C6 00 01         [ 1]  144 	ld a,fmstr 
      000024 AE 00 E8         [ 2]  145 	ldw x,#0xe8 
      000027 42               [ 4]  146 	mul x,a
      000028 89               [ 2]  147 	pushw x 
      000029 AE 00 03         [ 2]  148 	ldw x,#3 
      00002C 42               [ 4]  149 	mul x,a 
      00002D 5E               [ 1]  150 	swapw x 
      00002E 72 FB 01         [ 2]  151 	addw x,(1,sp) 
      000031                        152 	_drop 2  
      000031 5B 02            [ 2]    1     addw sp,#2 
      000033 4F               [ 1]  153 	clr a 
      000034                        154 0$:	 
      000034 A3 01 00         [ 2]  155 	cpw x,#256 
      000037 2B 04            [ 1]  156 	jrmi 1$ 
      000039 4C               [ 1]  157 	inc a 
      00003A 54               [ 2]  158 	srlw x 
      00003B 20 F7            [ 2]  159 	jra 0$ 
      00003D                        160 1$:
      00003D C7 53 45         [ 1]  161 	ld TIM4_PSCR,a 
      000040 9F               [ 1]  162 	ld a,xl 
      000041 C7 53 46         [ 1]  163 	ld TIM4_ARR,a
      000044 35 05 53 40      [ 1]  164 	mov TIM4_CR1,#((1<<TIM4_CR1_CEN)|(1<<TIM4_CR1_URS))
      000048 72 10 53 41      [ 1]  165 	bset TIM4_IER,#TIM4_IER_UIE
      00004C 81               [ 4]  166 	ret
                                    167 
                                    168 ;-------------------------------------
                                    169 ;  initialization entry point 
                                    170 ;-------------------------------------
      00004D                        171 cold_start:
                                    172 ;set stack 
      00004D AE 17 FF         [ 2]  173 	ldw x,#STACK_EMPTY
      000050 94               [ 1]  174 	ldw sp,x
                                    175 ; clear all ram 
      000051 7F               [ 1]  176 0$: clr (x)
      000052 5A               [ 2]  177 	decw x 
      000053 26 FC            [ 1]  178 	jrne 0$
                                    179 ; activate pull up on all inputs 
      000055 A6 FF            [ 1]  180 	ld a,#255 
      000057 C7 50 03         [ 1]  181 	ld PA_CR1,a 
      00005A C7 50 08         [ 1]  182 	ld PB_CR1,a 
      00005D C7 50 0D         [ 1]  183 	ld PC_CR1,a 
      000060 C7 50 12         [ 1]  184 	ld PD_CR1,a 
      000063 C7 50 17         [ 1]  185 	ld PE_CR1,a 
      000066 C7 50 1C         [ 1]  186 	ld PF_CR1,a 
      000069 C7 50 21         [ 1]  187 	ld PG_CR1,a 
      00006C C7 50 2B         [ 1]  188 	ld PI_CR1,a
                                    189 ; set user LED pin as output 
      00006F 72 1A 50 0D      [ 1]  190     bset LED_PORT+GPIO_CR1,#LED_BIT
      000073 72 1A 50 0E      [ 1]  191     bset LED_PORT+GPIO_CR2,#LED_BIT
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 36.
Hexadecimal [24-Bits]



      000077 72 1A 50 0C      [ 1]  192     bset LED_PORT+ GPIO_DDR,#LED_BIT
                                    193 ; select internal clock no divisor: 16 Mhz 	
      00007B 72 5F 50 C6      [ 1]  194 	clr CLK_CKDIVR ; 16Mhz HSI 
      00007F 35 10 00 01      [ 1]  195 	mov fmstr,#16
      000083 CD 00 19         [ 4]  196 	call timer4_init ; msec ticks timer 
                                    197 ; UART at 115200 BAUD
                                    198 ; used for user interface 
      000086 CD 00 AB         [ 4]  199 	call uart_init
      000089 9A               [ 1]  200 	rim ; enable interrupts 
      00008A CC 02 CE         [ 2]  201 	jp eeProg 
      00008D 20 FE            [ 2]  202 	jra . 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 37.
Hexadecimal [24-Bits]



                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2025  
                                      3 ; This file is part of eeprom-programmer 
                                      4 ;
                                      5 ;     eeprom-programmer is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     eeprom-programmer is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with eeprom-programmer.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 
                                     19 ;------------------------------
                                     20 ; This file is for functions 
                                     21 ; interfacing with VT100 terminal
                                     22 ; emulator.
                                     23 ;------------------------------
                                     24 
                                     25     .module TERMINAL  
                                     26 
                                     27     .area CODE 
                                     28 
                                     29 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     30 ;;   UART subroutines
                                     31 ;;   used for user interface 
                                     32 ;;   communication channel.
                                     33 ;;   settings: 
                                     34 ;;		115200 8N1 no flow control
                                     35 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     36 
                                     37 
                                     38 
                                     39 	.area CODE
                                     40 
                                     41 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     42 ;;; Uart1 intterrupt handler 
                                     43 ;;; on receive character 
                                     44 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     45 ;--------------------------
                                     46 ; UART receive character
                                     47 ; in a FIFO buffer 
                                     48 ; CTRL+C (ASCII 3)
                                     49 ; cancel program execution
                                     50 ; and fall back to command line
                                     51 ; CTRL+X reboot system 
                                     52 ; CTLR+Z erase EEPROM autorun 
                                     53 ;        information and reboot
                                     54 ;--------------------------
      00008F                         55 UartRxHandler: ; console receive char 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 38.
Hexadecimal [24-Bits]



      00008F 72 0B 52 30 16   [ 2]   56 	btjf UART_SR,#UART_SR_RXNE,5$ 
      000094 C6 52 31         [ 1]   57 	ld a,UART_DR 
      000097 88               [ 1]   58 	push a 
      000098 A6 0A            [ 1]   59 	ld a,#rx1_queue 
      00009A CB 00 09         [ 1]   60 	add a,rx1_tail 
      00009D 5F               [ 1]   61 	clrw x 
      00009E 97               [ 1]   62 	ld xl,a 
      00009F 84               [ 1]   63 	pop a 
      0000A0 F7               [ 1]   64 	ld (x),a 
      0000A1 C6 00 09         [ 1]   65 	ld a,rx1_tail 
      0000A4 4C               [ 1]   66 	inc a 
      0000A5 A4 1F            [ 1]   67 	and a,#RX_QUEUE_SIZE-1
      0000A7 C7 00 09         [ 1]   68 	ld rx1_tail,a 
      0000AA                         69 5$:	
      0000AA 80               [11]   70 	iret 
                                     71 
                                     72 
                                     73 ;---------------------------------------------
                                     74 ; initialize UART, 115200 8N1
                                     75 ; called from cold_start in hardware_init.asm 
                                     76 ; input:
                                     77 ;	none
                                     78 ; output:
                                     79 ;   none
                                     80 ;---------------------------------------------
                           01C200    81 BAUD_RATE=115200
                                     82 ; BRR value = 16Mhz/115200 = 0x8B  
                           000008    83 BRR1_VAL=8 
                           00000B    84 BRR2_VAL=0xB
      0000AB                         85 uart_init:
      0000AB A6 0B            [ 1]   86 	ld a,#BRR2_VAL
      0000AD C7 52 33         [ 1]   87 	ld UART_BRR2,a 
      0000B0 A6 08            [ 1]   88 	ld a,#BRR1_VAL  
      0000B2 C7 52 32         [ 1]   89 	ld UART_BRR1,a
      0000B5 72 5F 52 31      [ 1]   90     clr UART_DR
      0000B9 35 2C 52 35      [ 1]   91 	mov UART_CR2,#((1<<UART_CR2_TEN)|(1<<UART_CR2_REN)|(1<<UART_CR2_RIEN));
      0000BD 72 10 52 35      [ 1]   92 	bset UART_CR2,#UART_CR2_SBK
      0000C1 72 0D 52 30 FB   [ 2]   93     btjf UART_SR,#UART_SR_TC,.
      0000C6 CD 00 CA         [ 4]   94 	call clear_queue
      0000C9 81               [ 4]   95 	ret
                                     96 
                                     97 ;---------------------------
                                     98 ;  clear rx1_queue 
                                     99 ;---------------------------
      0000CA                        100 clear_queue:
      0000CA                        101     _clrz rx1_head 
      0000CA 3F 08                    1     .byte 0x3f, rx1_head 
      0000CC                        102 	_clrz rx1_tail 
      0000CC 3F 09                    1     .byte 0x3f, rx1_tail 
      0000CE 81               [ 4]  103 	ret 
                                    104 
                                    105 
                                    106 ;---------------------------------
                                    107 ; uart_putc
                                    108 ; send a character via UART
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 39.
Hexadecimal [24-Bits]



                                    109 ; input:
                                    110 ;    A  	character to send
                                    111 ;---------------------------------
      0000CF                        112 putc::
      0000CF                        113 uart_putc:: 
      0000CF 72 0F 52 30 FB   [ 2]  114 	btjf UART_SR,#UART_SR_TXE,.
      0000D4 C7 52 31         [ 1]  115 	ld UART_DR,a 
      0000D7 81               [ 4]  116 	ret 
                                    117 
                                    118 
                                    119 ;---------------------------------
                                    120 ; Query for character in rx1_queue
                                    121 ; input:
                                    122 ;   none 
                                    123 ; output:
                                    124 ;   A     0 no charcter available
                                    125 ;   Z     1 no character available
                                    126 ;---------------------------------
      0000D8                        127 qgetc::
      0000D8                        128 uart_qgetc::
      0000D8                        129 	_ldaz rx1_head 
      0000D8 B6 08                    1     .byte 0xb6,rx1_head 
      0000DA C0 00 09         [ 1]  130 	sub a,rx1_tail 
      0000DD 81               [ 4]  131 	ret 
                                    132 
                                    133 ;---------------------------------
                                    134 ; wait character from UART 
                                    135 ; input:
                                    136 ;   none
                                    137 ; output:
                                    138 ;   A 			char  
                                    139 ;--------------------------------	
      0000DE                        140 getc:: ;console input
      0000DE                        141 uart_getc::
      0000DE CD 00 D8         [ 4]  142 	call uart_qgetc
      0000E1 27 FB            [ 1]  143 	jreq uart_getc 
      0000E3 89               [ 2]  144 	pushw x 
                                    145 ;; rx1_queue must be in page 0 	
      0000E4 A6 0A            [ 1]  146 	ld a,#rx1_queue
      0000E6 CB 00 08         [ 1]  147 	add a,rx1_head 
      0000E9 5F               [ 1]  148 	clrw x  
      0000EA 97               [ 1]  149 	ld xl,a 
      0000EB F6               [ 1]  150 	ld a,(x)
      0000EC 88               [ 1]  151 	push a
      0000ED                        152 	_ldaz rx1_head 
      0000ED B6 08                    1     .byte 0xb6,rx1_head 
      0000EF 4C               [ 1]  153 	inc a 
      0000F0 A4 1F            [ 1]  154 	and a,#RX_QUEUE_SIZE-1
      0000F2                        155 	_straz rx1_head 
      0000F2 B7 08                    1     .byte 0xb7,rx1_head 
      0000F4 84               [ 1]  156 	pop a 
      0000F5 72 01 00 07 0A   [ 2]  157 	btjf flags,#FUPPER,1$
      0000FA A1 61            [ 1]  158 	cp a,#'a 
      0000FC 2B 06            [ 1]  159 	jrmi 1$
      0000FE A1 7B            [ 1]  160 	cp a,#'z+1 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 40.
Hexadecimal [24-Bits]



      000100 2B 02            [ 1]  161 	jrmi 1$ 
      000102 A4 DF            [ 1]  162 	and a,#0xDF  
      000104                        163 1$: 
      000104 85               [ 2]  164 	popw x
      000105 81               [ 4]  165 	ret 
                                    166 
                                    167 ;-----------------------------
                                    168 ; send an ASCIZ string to UART 
                                    169 ; input: 
                                    170 ;   x 		char * 
                                    171 ; output:
                                    172 ;   none 
                                    173 ;-------------------------------
      000106                        174 puts::
      000106 F6               [ 1]  175     ld a,(x)
      000107 27 06            [ 1]  176 	jreq 1$
      000109 CD 00 CF         [ 4]  177 	call putc 
      00010C 5C               [ 1]  178 	incw x 
      00010D 20 F7            [ 2]  179 	jra puts 
      00010F 5C               [ 1]  180 1$:	incw x 
      000110 81               [ 4]  181 	ret 
                                    182 
                                    183 ;---------------------------
                                    184 ; delete character at left 
                                    185 ; of cursor on terminal 
                                    186 ; input:
                                    187 ;   none 
                                    188 ; output:
                                    189 ;	none 
                                    190 ;---------------------------
      000111                        191 uart_bksp::
      000111                        192 bksp::
      000111 88               [ 1]  193 	push a 
      000112 A6 08            [ 1]  194 	ld a,#BS 
      000114 CD 00 CF         [ 4]  195 	call putc  
      000117 A6 20            [ 1]  196 	ld a,#SPACE 
      000119 CD 00 CF         [ 4]  197 	call putc 
      00011C A6 08            [ 1]  198 	ld a,#BS 
      00011E CD 00 CF         [ 4]  199 	call putc 
      000121 84               [ 1]  200 	pop a 
      000122 81               [ 4]  201 	ret 
                                    202  
                                    203 
                                    204 ;---------------------------
                                    205 ; send LF character 
                                    206 ; terminal interpret it 
                                    207 ; as CRLF 
                                    208 ;---------------------------
      000123                        209 new_line:: 
      000123 A6 0D            [ 1]  210 	ld a,#CR  
      000125 CD 00 CF         [ 4]  211 	call putc 
      000128 81               [ 4]  212 	ret 
                                    213 
                                    214 ;--------------------------
                                    215 ; erase terminal screen 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 41.
Hexadecimal [24-Bits]



                                    216 ;--------------------------
      000129                        217 clr_screen::
      000129 A6 1B            [ 1]  218 	ld a,#ESC 
      00012B CD 00 CF         [ 4]  219 	call putc 
      00012E A6 63            [ 1]  220 	ld a,#'c 
      000130 CD 00 CF         [ 4]  221 	call putc 
      000133 81               [ 4]  222 	ret 
                                    223 
                                    224 ;--------------------------
                                    225 ; output a single space
                                    226 ;--------------------------
      000134                        227 space::
      000134 88               [ 1]  228 	push a 
      000135 A6 20            [ 1]  229 	ld a,#SPACE 
      000137 CD 00 CF         [ 4]  230 	call putc 
      00013A 84               [ 1]  231 	pop a 
      00013B 81               [ 4]  232 	ret 
                                    233 
                                    234 ;--------------------------
                                    235 ; print n spaces on terminal
                                    236 ; input:
                                    237 ;  X 		number of spaces 
                                    238 ; output:
                                    239 ;	none 
                                    240 ;---------------------------
      00013C                        241 spaces::
      00013C A6 20            [ 1]  242 	ld a,#SPACE 
      00013E 5D               [ 2]  243 1$:	tnzw x
      00013F 27 06            [ 1]  244 	jreq 9$
      000141 CD 00 CF         [ 4]  245 	call putc 
      000144 5A               [ 2]  246 	decw x
      000145 20 F7            [ 2]  247 	jra 1$
      000147                        248 9$: 
      000147 81               [ 4]  249 	ret 
                                    250 
                                    251 ;--------------------------
                                    252 ; this version of readln 
                                    253 ; if to be used with 
                                    254 ; non ANSI terminal 
                                    255 ; like STM8_terminal 
                                    256 ; 
                                    257 ; BS      delete last character 
                                    258 ; input:
                                    259 ;   A     initial line length
                                    260 ; output:
                                    261 ;   A     line length 
                                    262 ;   X     tib address 
                                    263 ;--------------------------
                           00007F   264 MAX_LEN=TIB_SIZE-1
                           000001   265 	HI_LL=1
                           000002   266 	LN_LEN=2
                           000003   267 	CHAR=3 
                           000003   268 	VSIZE=CHAR  
      000148                        269 readln::
      000148                        270 	_vars VSIZE
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 42.
Hexadecimal [24-Bits]



      000148 52 03            [ 2]    1     sub sp,#VSIZE 
      00014A 0F 03            [ 1]  271 	clr (CHAR,sp) 
      00014C 0F 01            [ 1]  272 	clr (HI_LL,sp)
      00014E 6B 02            [ 1]  273 	ld (LN_LEN,sp),a
      000150 AE 16 C0         [ 2]  274 	ldw x,#tib 
      000153 4D               [ 1]  275 	tnz a 
      000154 27 09            [ 1]  276 	jreq 1$
      000156 CD 01 06         [ 4]  277 	call puts 
      000159 AE 16 C0         [ 2]  278 	ldw x,#tib
      00015C 72 FB 01         [ 2]  279 	addw x,(HI_LL,sp)
      00015F                        280 1$:
      00015F CD 00 DE         [ 4]  281 	call uart_getc
      000162 CD 02 51         [ 4]  282 	call to_upper
      000165 6B 03            [ 1]  283 	ld (CHAR,sp),a 
      000167 A1 20            [ 1]  284 	cp a,#SPACE 
      000169 24 1D            [ 1]  285 	jruge 4$
      00016B A1 0D            [ 1]  286 	cp a,#CR 
      00016D 26 02            [ 1]  287 	jrne 2$
      00016F 20 2B            [ 2]  288 	jra 9$ 
      000171                        289 2$:
      000171 A1 0A            [ 1]  290 	cp a,#LF 
      000173 26 02            [ 1]  291 	jrne 3$
      000175 20 25            [ 2]  292 	jra 9$
      000177                        293 3$:
      000177 A1 08            [ 1]  294 	cp a,#BS 
      000179 26 E4            [ 1]  295 	jrne 1$ 
      00017B 0D 02            [ 1]  296 	tnz (LN_LEN,sp)
      00017D 27 E0            [ 1]  297 	jreq 1$ 
      00017F CD 01 11         [ 4]  298 	call bksp 
      000182 5A               [ 2]  299 	decw x 
      000183 7F               [ 1]  300 	clr (x)
      000184 0A 02            [ 1]  301 	dec (LN_LEN,sp)
      000186 20 D7            [ 2]  302 	jra 1$ 
      000188                        303 4$:	
                                    304 ; append character to end of line 
      000188 7B 02            [ 1]  305 	ld a,(LN_LEN,sp)
      00018A A1 7F            [ 1]  306 	cp a,#MAX_LEN 
      00018C 2B 02            [ 1]  307 	jrmi 5$
      00018E 20 CF            [ 2]  308     jra 1$ 
      000190                        309 5$:
      000190 7B 03            [ 1]  310 	ld a,(CHAR,sp)
      000192 CD 00 CF         [ 4]  311 	call uart_putc 
      000195 F7               [ 1]  312 	ld (x),a 
      000196 5C               [ 1]  313 	incw x 
      000197 7F               [ 1]  314 	clr (x)
      000198 0C 02            [ 1]  315 	inc (LN_LEN,sp)
      00019A 20 C3            [ 2]  316 	jra 1$ 
      00019C CD 00 CF         [ 4]  317 9$:	call uart_putc  
      00019F                        318 10$: 
      00019F AE 16 C0         [ 2]  319 	ldw x,#tib 
      0001A2 7B 02            [ 1]  320 	ld a,(LN_LEN,sp)
      0001A4                        321 	_drop VSIZE 
      0001A4 5B 03            [ 2]    1     addw sp,#VSIZE 
      0001A6 81               [ 4]  322 	ret 
                                    323 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 43.
Hexadecimal [24-Bits]



                                    324 ;----------------------------------
                                    325 ; convert to hexadecimal digit 
                                    326 ; input:
                                    327 ;   A       digit to convert 
                                    328 ; output:
                                    329 ;   A       hexdecimal character 
                                    330 ;----------------------------------
      0001A7                        331 to_hex_char::
      0001A7 A4 0F            [ 1]  332 	and a,#15 
      0001A9 A1 0A            [ 1]  333 	cp a,#10 
      0001AB 2B 02            [ 1]  334 	jrmi 1$ 
      0001AD AB 07            [ 1]  335 	add a,#7
      0001AF AB 30            [ 1]  336 1$: add a,#'0 
      0001B1 81               [ 4]  337 	ret 
                                    338 
                                    339 ;------------------------------
                                    340 ; print byte  in hexadecimal 
                                    341 ; on console
                                    342 ; no space separator 
                                    343 ; input:
                                    344 ;    A		byte to print
                                    345 ;------------------------------
      0001B2                        346 print_hex::
      0001B2 88               [ 1]  347 	push a 
      0001B3 4E               [ 1]  348 	swap a 
      0001B4 CD 01 A7         [ 4]  349 	call to_hex_char 
      0001B7 CD 00 CF         [ 4]  350 	call putc 
      0001BA 84               [ 1]  351     pop a  
      0001BB CD 01 A7         [ 4]  352 	call to_hex_char
      0001BE CD 00 CF         [ 4]  353 	call putc   
      0001C1 81               [ 4]  354 	ret 
                                    355 
                                    356 ;------------------------------
                                    357 ; print A in decimal base 
                                    358 ; not space after, no leading 
                                    359 ; zero.
                                    360 ; input:
                                    361 ;    A    int8 to print 
                                    362 ;-------------------------------
      0001C2                        363 print_dec:
      0001C2 89               [ 2]  364 	pushw x 
      0001C3 5F               [ 1]  365 	clrw x 
      0001C4 97               [ 1]  366 	ld xl,a 
      0001C5 A6 0A            [ 1]  367 	ld a,#10
      0001C7 62               [ 2]  368 	div x,a  
      0001C8 88               [ 1]  369 	push a 
      0001C9 A6 0A            [ 1]  370 	ld a,#10 
      0001CB 62               [ 2]  371 	div x,a 
      0001CC 88               [ 1]  372 	push a 
      0001CD 9F               [ 1]  373 	ld a,xl 
      0001CE 4D               [ 1]  374 	tnz a 
      0001CF 27 03            [ 1]  375 	jreq 1$ 
      0001D1 CD 01 E1         [ 4]  376 	call prt_digit 
      0001D4 84               [ 1]  377 1$: pop a 
      0001D5 4D               [ 1]  378 	tnz a 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 44.
Hexadecimal [24-Bits]



      0001D6 27 03            [ 1]  379 	jreq 2$ 
      0001D8 CD 01 E1         [ 4]  380 	call prt_digit 
      0001DB 84               [ 1]  381 2$:	pop a 
      0001DC CD 01 E1         [ 4]  382 	call prt_digit 
      0001DF 85               [ 2]  383 	popw x 
      0001E0 81               [ 4]  384 	ret 
      0001E1                        385 prt_digit:
      0001E1 AB 30            [ 1]  386 	add a,#'0 
      0001E3 CD 00 CF         [ 4]  387 	call putc 
      0001E6 81               [ 4]  388 	ret 
                                    389 
                                    390 
                                    391 ;------------------------
                                    392 ; print int8 
                                    393 ; input:
                                    394 ;    A    int8 
                                    395 ; output:
                                    396 ;    none 
                                    397 ;-----------------------
      0001E7                        398 prt_i8:
      0001E7 5F               [ 1]  399 	clrw x 
      0001E8 97               [ 1]  400 	ld xl,a  
                                    401 
                                    402 
                                    403 ;------------------------------------
                                    404 ; print integer  
                                    405 ; input:
                                    406 ;	X  		    integer to print 
                                    407 ;	'base' 		numerical base for conversion 
                                    408 ;    A 			signed||unsigned conversion
                                    409 ;  output:
                                    410 ;    A          string length
                                    411 ;------------------------------------
      0001E9                        412 print_int::
      0001E9                        413 	_ldaz base 
      0001E9 B6 00                    1     .byte 0xb6,base 
      0001EB A0 10            [ 1]  414 	sub a,#16 
      0001ED 27 02            [ 1]  415 	jreq 1$
      0001EF A6 FF            [ 1]  416 	ld a,#255  ; signed conversion  when base 10 
      0001F1                        417 1$:
      0001F1 CD 01 FA         [ 4]  418     call itoa  ; conversion entier en  .asciz
      0001F4 88               [ 1]  419 	push a 
      0001F5 CD 01 06         [ 4]  420 	call puts
      0001F8 84               [ 1]  421 	pop a 
      0001F9 81               [ 4]  422     ret	
                                    423 
                                    424 ;------------------------------------
                                    425 ; convert integer in x to string
                                    426 ; input:
                                    427 ;   'base'	conversion base 
                                    428 ;	X   	integer to convert
                                    429 ;   A       0=unsigned, else signed 
                                    430 ; output:
                                    431 ;   X  		pointer to first char of string
                                    432 ;   A       string length
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 45.
Hexadecimal [24-Bits]



                                    433 ; use:
                                    434 ;   pad     to build string 
                                    435 ;------------------------------------
                           000001   436 	SIGN=1  ; 1 byte, integer sign 
                           000002   437 	LEN=SIGN+1   ; 1 byte, string length 
                           000002   438 	VSIZE=2 ;locals size
      0001FA                        439 itoa::
      0001FA 90 89            [ 2]  440 	pushw y 
      0001FC                        441 	_vars VSIZE
      0001FC 52 02            [ 2]    1     sub sp,#VSIZE 
      0001FE 0F 02            [ 1]  442 	clr (LEN,sp) ; string length  
      000200 0F 01            [ 1]  443 	clr (SIGN,sp)    ; sign
      000202 4D               [ 1]  444 	tnz a
      000203 27 06            [ 1]  445 	jreq 1$ ; unsigned conversion  
      000205 5D               [ 2]  446 	tnzw x 
      000206 2A 03            [ 1]  447 	jrpl 1$ 
      000208 03 01            [ 1]  448 	cpl (SIGN,sp)
      00020A 50               [ 2]  449 	negw x 
      00020B                        450 1$:
                                    451 ; initialize string pointer 
                                    452 ; build string at end of pad  
      00020B 90 AE 17 40      [ 2]  453 	ldw y,#pad 
      00020F 72 A9 00 40      [ 2]  454 	addw y,#PAD_SIZE 
      000213 90 5A            [ 2]  455 	decw y 
      000215 90 7F            [ 1]  456 	clr (y)
      000217 A6 20            [ 1]  457 	ld a,#SPACE
      000219 90 5A            [ 2]  458 	decw y
      00021B 90 F7            [ 1]  459 	ld (y),a 
      00021D 0C 02            [ 1]  460 	inc (LEN,sp)
      00021F                        461 itoa_loop:
      00021F                        462     _ldaz base 
      00021F B6 00                    1     .byte 0xb6,base 
      000221 62               [ 2]  463     div x,a 
      000222 AB 30            [ 1]  464     add a,#'0  ; remainder of division
      000224 A1 3A            [ 1]  465     cp a,#'9+1
      000226 2B 02            [ 1]  466     jrmi 2$
      000228 AB 07            [ 1]  467     add a,#7 
      00022A                        468 2$:	
      00022A 90 5A            [ 2]  469 	decw y
      00022C 90 F7            [ 1]  470     ld (y),a
      00022E 0C 02            [ 1]  471 	inc (LEN,sp)
                                    472 ; if x==0 conversion done
      000230 5D               [ 2]  473 	tnzw x 
      000231 26 EC            [ 1]  474     jrne itoa_loop
      000233                        475 	_ldaz base 
      000233 B6 00                    1     .byte 0xb6,base 
      000235 A0 0A            [ 1]  476 	sub a,#10 
      000237 27 04            [ 1]  477 	jreq 3$
      000239 A6 24            [ 1]  478 	ld a,#'$ 
      00023B 20 06            [ 2]  479 	jra 4$
      00023D                        480 3$:
      00023D 7B 01            [ 1]  481 	ld a,(SIGN,sp)
      00023F 27 08            [ 1]  482     jreq 10$
      000241 A6 2D            [ 1]  483     ld a,#'-
      000243                        484 4$:
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 46.
Hexadecimal [24-Bits]



      000243 90 5A            [ 2]  485     decw y
      000245 90 F7            [ 1]  486     ld (y),a
      000247 0C 02            [ 1]  487 	inc (LEN,sp)
      000249                        488 10$:
      000249 7B 02            [ 1]  489 	ld a,(LEN,sp)
      00024B 93               [ 1]  490 	ldw x,y 
      00024C                        491 	_drop VSIZE
      00024C 5B 02            [ 2]    1     addw sp,#VSIZE 
      00024E 90 85            [ 2]  492 	popw y 
      000250 81               [ 4]  493 	ret
                                    494 
                                    495 ;--------------------------
                                    496 ; convert lower letters 
                                    497 ; to upper case 
                                    498 ; input:
                                    499 ;    A 
                                    500 ; output:
                                    501 ;    A 
                                    502 ;-------------------------
      000251                        503 to_upper:
      000251 A1 61            [ 1]  504 	cp a,#'a 
      000253 2B 06            [ 1]  505 	jrmi 9$ 
      000255 A1 7B            [ 1]  506 	cp a,#'z+1 
      000257 2A 02            [ 1]  507 	jrpl 9$ 
      000259 A4 DF            [ 1]  508 	and a,#0xDF 
      00025B                        509 9$:
      00025B 81               [ 4]  510 	ret 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 47.
Hexadecimal [24-Bits]



                                      1 ;;
                                      2 ; Copyright Jacques Deschênes 2025  
                                      3 ; This file is part of eeprom-programmer 
                                      4 ;
                                      5 ;     eeprom-programmer is free software: you can redistribute it and/or modify
                                      6 ;     it under the terms of the GNU General Public License as published by
                                      7 ;     the Free Software Foundation, either version 3 of the License, or
                                      8 ;     (at your option) any later version.
                                      9 ;
                                     10 ;     eeprom-programmer is distributed in the hope that it will be useful,
                                     11 ;     but WITHOUT ANY WARRANTY; without even the implied warranty of
                                     12 ;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                                     13 ;     GNU General Public License for more details.
                                     14 ;
                                     15 ;     You should have received a copy of the GNU General Public License
                                     16 ;     along with eeprom-programmer.  If not, see <http://www.gnu.org/licenses/>.
                                     17 ;;
                                     18 
                                     19 
                                     20 ;;---------------------------------------
                                     21 ;; at28C64B || at28c256  EEPROM programmer 
                                     22 ;;--------------------------------------
                                     23 
                                     24 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     25 ;;   COMMENTS 
                                     26 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
                                     27 ;; 1) Apple I keyboard interface was setting 
                                     28 ;;    setting bit 7 to 1 
                                     29 ;;     no need for it here 
                                     30 ;; 2) STM8 have 16 bits X,Y registers 
                                     31 ;;    I use this facility to avoid page 0
                                     32 ;;    pointers  
                                     33 ;; 3) STM8 have stack relative addressing 
                                     34 ;;    also very helpfull to avoid global 
                                     35 ;;    variables in RAM.  
                                     36 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     37 
                                     38     .module EEPROG  
                                     39 
                                     40 
                           00501E    41     ADDR_HIGH=PG_ODR 
                           00500F    42     ADDR_LOW=PD_ODR 
                           005005    43     DATA_ODR=PB_ODR
                           005006    44     DATA_IDR=PB_IDR 
                           005007    45     DATA_DDR=PB_DDR
                           005008    46     DATA_CR1=PB_CR1 
                           005009    47     DATA_CR2=PB_CR2  
                           00500A    48     EEPROM_CTRL=PC_ODR 
                           000001    49     EEPROM_NCE=BIT1 ; eeprom enable 
                           000002    50     EEPROM_NOE=BIT2 ; eeprom output enable 
                           000003    51     EEPROM_NWE=BIT3 ; eeprom write enable 
                                     52 
                           000040    53     EEPROM_PAGE_SIZE=64
                                     54 
                                     55 ;--------------------------------
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 48.
Hexadecimal [24-Bits]



                                     56 ;     MACROS 
                                     57 ;--------------------------------
                                     58 
                                     59     ; reset eeprom ~CE bit 
                                     60     ; activate eeprom
                                     61     ; must be in this state 
                                     62     ; for read/prog operations  
                                     63     .macro _eeprom_enable  
                                     64         bres EEPROM_CTRL,#EEPROM_NCE 
                                     65     .endm 
                                     66 
                                     67     ; set eeprom ~CE bit 
                                     68     ; put eeprom in low power mode 
                                     69     ; data pin are in hi-z state 
                                     70     ; can't be read/prog in this state 
                                     71     .macro _eeprom_disable 
                                     72         bset EEPROM_CTRL,#EEPROM_NCE
                                     73     .endm 
                                     74 
                                     75     ; reset eeprom ~OE bit
                                     76     ; must be low to read eeprom  
                                     77     .macro _eeprom_enabe_output 
                                     78         bres EEPROM_CTRL,#EEPROM_NOE 
                                     79     .endm 
                                     80 
                                     81     ; set eeprom ~OE bit
                                     82     ; must be high to program eeprom  
                                     83     .macro _eeprom_disable_output 
                                     84         bset EEPROM_CTRL,#EEPROM_NOE
                                     85     .endm 
                                     86 
                                     87     ; reset eeprom ~WE bit 
                                     88     .macro _eeprom_we_low  
                                     89         bres EEPROM_CTRL,#EEPROM_NWE
                                     90     .endm 
                                     91 
                                     92     ; set eeprom ~WE bit 
                                     93     .macro _eeprom_we_high 
                                     94         bset EEPROM_CTRL,#EEPROM_NWE
                                     95     .endm 
                                     96 
                                     97     ; eeprom programming delay 
                                     98     ; 11msec per 64 bytes page 
                                     99     .macro _prog_delay 
                                    100         ld a,#10
                                    101         _straz timer+1
                                    102         _clrz timer  
                                    103         bset flags,#FTIMER 
                                    104         btjt flags,#FTIMER,.
                                    105     .endm 
                                    106 
                                    107     ; set DATA port as output 
                                    108     .macro _data_output 
                                    109         ld a,#255 
                                    110         ld DATA_CR1,a ; push pull output mode 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 49.
Hexadecimal [24-Bits]



                                    111         ld DATA_CR2,a ; high_speed  
                                    112         ld DATA_DDR,a ; output mode 
                                    113     .endm 
                                    114 
                                    115     ; set DATA port as input 
                                    116     .macro _data_input
                                    117         clr DATA_CR1  ; floating input
                                    118         clr DATA_CR2  ; disable ineterrupt
                                    119         clr DATA_DDR  ; input mode
                                    120     .endm 
                                    121 
                                    122     ;configure data port for output 
                                    123     ; and enable eeprom ~OE bit.
                                    124     .macro _config_write 
                                    125         _data_output
                                    126         _eeprom_disable_output
                                    127     .endm 
                                    128 
                                    129     ; configure data port for input 
                                    130     ; and disable eeprom ~OE bit 
                                    131     .macro _config_read 
                                    132         _data_input
                                    133         _eeprom_enabe_output
                                    134     .endm 
                                    135 
                                    136     ; data in A 
                                    137     .macro _eeprom_write  
                                    138         _eeprom_we_low 
                                    139         nop 
                                    140         nop 
                                    141         ld DATA_ODR,a
                                    142         nop
                                    143         nop 
                                    144         _eeprom_we_high   
                                    145     .endm 
                                    146 
                                    147     ; read eeprom data in A 
                                    148     .macro _eeprom_read  
                                    149         ld a,DATA_IDR  
                                    150     .endm 
                                    151 
                                    152 
                                    153 ;;--------------------------------------
                                    154     .area CODE
                                    155 ;;--------------------------------------
                                    156 
                                    157 
                                    158 ;--------------------------------------------------
                                    159 ; command line interface
                                    160 ; input formats:
                                    161 ;       hex_number  -> display byte at that address 
                                    162 ;       hex_number.hex_number -> display bytes in that range 
                                    163 ;       hex_number: hex_byte [hex_byte]*  -> write to EEPROM data bytes  
                                    164 ;       hex_number"STRING   write string in EEPROM 
                                    165 ;       hex_numberXhex_number  erase range filling eeprom with FF 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 50.
Hexadecimal [24-Bits]



                                    166 ;----------------------------------------------------
                                    167 ; operatiing modes 
                           000000   168     NOP=0
                           000001   169     READ=1 ; single address or block
                           000002   170     STORE=2 
                           000003   171     ERASE=3 ; fill range with 0xFF 
                                    172 
                                    173     ; get next character from input buffer 
                                    174     .macro _next_char 
                                    175     ld a,(y)
                                    176     incw y 
                                    177     .endm ; 4 bytes, 2 cy 
                                    178 
                                    179 
                                    180 ;---------------------------
                                    181 ; initialize ports used 
                                    182 ; to interface to EEPROM 
                                    183 ; PORT G  address bits 15:8 
                                    184 ; PORT D  address bits 7:0 
                                    185 ; PORT B  data bits 
                                    186 ; PORT C  bits 1,2,3 as controls lines 
                                    187 ;----------------------------  
      00025C                        188 init_ports:
                                    189 ; PORT G (ADDR_HIGH) as output push-pull 
      00025C A6 FF            [ 1]  190     ld a,#255 
      00025E C7 50 20         [ 1]  191     ld PG_DDR,a ; output 
      000261 C7 50 21         [ 1]  192     ld PG_CR1,a ; push-pull 
      000264 C7 50 22         [ 1]  193     ld PG_CR2,a ; high speed 
      000267 72 5F 50 1E      [ 1]  194     clr ADDR_HIGH     
                                    195 ; PORT D (ADDR_LOW) as outpout push-pull 
      00026B C7 50 11         [ 1]  196     ld PD_DDR,a ; output 
      00026E C7 50 12         [ 1]  197     ld PD_CR1,a ; push-pull 
      000271 C7 50 13         [ 1]  198     ld PD_CR2,a ; high speed 
      000274 72 5F 50 0F      [ 1]  199     clr ADDR_LOW  
                                    200 ; PORT C (control lines) bits 1,2,3 as output push-pull 
      000278 A6 0E            [ 1]  201     ld a,#(1<<EEPROM_NCE)+(1<<EEPROM_NOE)+(1<<EEPROM_NWE)
      00027A C7 50 0A         [ 1]  202     ld PC_ODR,a ; all control lines to high 
      00027D C7 50 0D         [ 1]  203     ld PC_CR1,a ; push-pull 
      000280 C7 50 0E         [ 1]  204     ld PC_CR2,a ; high-speed 
      000283 C7 50 0C         [ 1]  205     ld PC_DDR,a ; output 
      000286                        206     _eeprom_enable 
      000286 72 13 50 0A      [ 1]    1         bres EEPROM_CTRL,#EEPROM_NCE 
      00028A                        207     _config_read
      00028A                          1         _data_input
      00028A 72 5F 50 08      [ 1]    1         clr DATA_CR1  ; floating input
      00028E 72 5F 50 09      [ 1]    2         clr DATA_CR2  ; disable ineterrupt
      000292 72 5F 50 07      [ 1]    3         clr DATA_DDR  ; input mode
      000296                          2         _eeprom_enabe_output
      000296 72 15 50 0A      [ 1]    1         bres EEPROM_CTRL,#EEPROM_NOE 
      00029A 81               [ 4]  208     ret 
                                    209 
                                    210 ;----------------------
                                    211 ;  eeProg entry point 
                                    212 ;---------------------
      00029B 65 65 50 72 6F 67 2C   213 EEPROG_tibFO: .asciz "eeProg, Copyright Jacques Deschenes, 2025\nversion "
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 51.
Hexadecimal [24-Bits]



             20 43 6F 70 79 72 69
             67 68 74 20 4A 61 63
             71 75 65 73 20 44 65
             73 63 68 65 6E 65 73
             2C 20 32 30 32 35 0A
             76 65 72 73 69 6F 6E
             20 00
      0002CE                        214 eeProg:
      0002CE CD 01 29         [ 4]  215     call clr_screen
      0002D1 AE 02 9B         [ 2]  216     ldw x,#EEPROG_tibFO 
      0002D4 CD 01 06         [ 4]  217     call puts 
      0002D7 A6 01            [ 1]  218     ld a,#MAJOR
      0002D9 CD 01 C2         [ 4]  219     call print_dec 
      0002DC A6 2E            [ 1]  220     ld a,#'. 
      0002DE CD 00 CF         [ 4]  221     call putc 
      0002E1 A6 00            [ 1]  222     ld a,#MINOR 
      0002E3 CD 01 C2         [ 4]  223     call print_dec
      0002E6 A6 2E            [ 1]  224     ld a,#'. 
      0002E8 CD 00 CF         [ 4]  225     call putc 
      0002EB A6 05            [ 1]  226     ld a,#REV 
      0002ED CD 01 C2         [ 4]  227     call print_dec
      0002F0 CD 01 23         [ 4]  228     call new_line 
      0002F3 CD 02 5C         [ 4]  229     call init_ports 
      0002F6 4F               [ 1]  230     clr a 
      0002F7                        231     _clrz xamadr 
      0002F7 3F 2B                    1     .byte 0x3f, xamadr 
      0002F9                        232     _clrz storadr 
      0002F9 3F 2D                    1     .byte 0x3f, storadr 
      0002FB                        233     _clrz last  
      0002FB 3F 2F                    1     .byte 0x3f, last 
      0002FD                        234 cli: 
      0002FD CD 01 23         [ 4]  235     call new_line
      000300 A6 23            [ 1]  236     ld a,#'# 
      000302 CD 00 CF         [ 4]  237     call putc ; prompt character 
      000305 4F               [ 1]  238     clr a
      000306 72 5F 16 C0      [ 1]  239     clr tib
      00030A CD 01 48         [ 4]  240     call readln
                                    241 ; analyze input line      
      00030D 90 93            [ 1]  242     ldw y,x  
      00030F                        243     _clrz mode 
      00030F 3F 2A                    1     .byte 0x3f, mode 
      000311                        244 next_char:     
      000311                        245     _next_char
      000311 90 F6            [ 1]    1     ld a,(y)
      000313 90 5C            [ 1]    2     incw y 
      000315 4D               [ 1]  246     tnz a     
      000316 26 0B            [ 1]  247     jrne parse01
                                    248 ; at end of line 
      000318 72 5D 00 2A      [ 1]  249      tnz mode 
      00031C 27 DF            [ 1]  250      jreq cli 
      00031E CD 03 A8         [ 4]  251     call exam_block 
      000321 20 DA            [ 2]  252     jra cli 
      000323                        253 parse01:
      000323 A1 22            [ 1]  254     cp a,#'" 
      000325 26 05            [ 1]  255     jrne 1$ 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 52.
Hexadecimal [24-Bits]



      000327 CD 04 C0         [ 4]  256     call write_string
      00032A 20 D1            [ 2]  257     jra cli 
      00032C                        258 1$: 
      00032C A1 58            [ 1]  259     cp a,#'X 
      00032E 26 06            [ 1]  260     jrne 2$ 
      000330 A6 03            [ 1]  261     ld a,#ERASE 
      000332                        262     _straz mode 
      000332 B7 2A                    1     .byte 0xb7,mode 
      000334 20 DB            [ 2]  263     jra next_char 
      000336                        264 2$:    
      000336 A1 3A            [ 1]  265     cp a,#':
      000338 26 05            [ 1]  266     jrne 5$ 
      00033A CD 03 72         [ 4]  267     call write_eeprom 
      00033D 20 BE            [ 2]  268     jra cli     
      00033F                        269 5$:
      00033F A1 2E            [ 1]  270     cp a,#'. 
      000341 26 06            [ 1]  271     jrne 7$ 
      000343 A6 01            [ 1]  272     ld a,#READ 
      000345                        273     _straz mode  
      000345 B7 2A                    1     .byte 0xb7,mode 
                                    274 ;    tnz mode 
                                    275 ;    jreq cli ; here mode should be set to 1 
      000347 20 C8            [ 2]  276     jra next_char 
      000349                        277 7$: 
      000349 A1 20            [ 1]  278     cp a,#SPACE 
      00034B 27 C4            [ 1]  279     jreq next_char ; skip separator and invalids characters  
      00034D CD 03 FE         [ 4]  280     call parse_hex ; maybe an hexadecimal number 
      000350 4D               [ 1]  281     tnz a ; unknown token ignore rest of line
      000351 27 AA            [ 1]  282     jreq cli 
      000353 72 5D 00 2A      [ 1]  283     tnz mode 
      000357 27 11            [ 1]  284     jreq 9$
      000359 A6 03            [ 1]  285     ld a,#ERASE 
      00035B C1 00 2A         [ 1]  286     cp a,mode 
      00035E 26 05            [ 1]  287     jrne 8$
      000360 CD 05 1F         [ 4]  288     call erase_range 
      000363 20 98            [ 2]  289     jra cli
      000365                        290 8$:
      000365 CD 03 A8         [ 4]  291     call exam_block
      000368 20 A7            [ 2]  292     jra next_char
      00036A                        293 9$:
      00036A                        294     _strxz xamadr 
      00036A BF 2B                    1     .byte 0xbf,xamadr 
      00036C                        295     _strxz storadr
      00036C BF 2D                    1     .byte 0xbf,storadr 
      00036E                        296     _incz mode
      00036E 3C 2A                    1     .byte 0x3c, mode 
      000370 20 9F            [ 2]  297     jra next_char 
                                    298 
                                    299 
                                    300 ;-------------------------------------
                                    301 ; write to eeprom 
                                    302 ; write data to pad then transfert to eeprom  
                                    303 ; read byte list from input buffer
                                    304 ; all bytes must be in same page.
                                    305 ; i.e. only bit 5:0 of address change
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 53.
Hexadecimal [24-Bits]



                                    306 ; maximum 64 bytes at once.
                                    307 ; if delay between _eeprom_write >150µSec 
                                    308 ; programming phase start.
                                    309 ;--------------------------------------
                           000001   310     PAGE_CNTR=1
      000372                        311 write_eeprom:
      000372 4B 40            [ 1]  312     push #EEPROM_PAGE_SIZE ; bytes per eeprom page 
                                    313 ; load data in pad 
      000374 AE 17 40         [ 2]  314     ldw x,#pad 
      000377                        315     _strxz ptr16
      000377 BF 05                    1     .byte 0xbf,ptr16 
      000379                        316 1$: 
                                    317 ; skip spaces 
      000379                        318     _next_char 
      000379 90 F6            [ 1]    1     ld a,(y)
      00037B 90 5C            [ 1]    2     incw y 
      00037D A1 20            [ 1]  319     cp a,#SPACE 
      00037F 27 F8            [ 1]  320     jreq 1$
      000381 A1 3B            [ 1]  321     cp a,#'; 
      000383 27 15            [ 1]  322     jreq 9$  
      000385 CD 03 FE         [ 4]  323     call parse_hex
      000388 4D               [ 1]  324     tnz a 
      000389 27 0F            [ 1]  325     jreq 9$
      00038B 9F               [ 1]  326     ld a,xl 
      00038C 72 C7 00 05      [ 4]  327     ld [ptr16],a 
      000390 72 5C 00 06      [ 1]  328     inc ptr8  
      000394 0A 01            [ 1]  329     dec (PAGE_CNTR,sp)
      000396 27 02            [ 1]  330     jreq 9$ 
      000398 20 DF            [ 2]  331     jra 1$ 
      00039A A6 40            [ 1]  332 9$: ld a,#EEPROM_PAGE_SIZE 
      00039C 10 01            [ 1]  333     sub a,(PAGE_CNTR,sp)
      00039E 27 03            [ 1]  334     jreq 10$
      0003A0 CD 04 60         [ 4]  335     call prog_eeprom 
      0003A3                        336 10$:
      0003A3                        337     _clrz mode 
      0003A3 3F 2A                    1     .byte 0x3f, mode 
      0003A5                        338     _drop 1 
      0003A5 5B 01            [ 2]    1     addw sp,#1 
      0003A7 81               [ 4]  339     ret 
                                    340 
                                    341 ;-------------------------------------------
                                    342 ; display memory in range 'xamadr'...'last' 
                                    343 ;-------------------------------------------    
                           000001   344     ROW_SIZE=1
                           000001   345     VSIZE=1
      0003A8                        346 exam_block:
      0003A8                        347     _vars VSIZE
      0003A8 52 01            [ 2]    1     sub sp,#VSIZE 
      0003AA                        348     _config_read ; to read data from eeprom  
      0003AA                          1         _data_input
      0003AA 72 5F 50 08      [ 1]    1         clr DATA_CR1  ; floating input
      0003AE 72 5F 50 09      [ 1]    2         clr DATA_CR2  ; disable ineterrupt
      0003B2 72 5F 50 07      [ 1]    3         clr DATA_DDR  ; input mode
      0003B6                          2         _eeprom_enabe_output
      0003B6 72 15 50 0A      [ 1]    1         bres EEPROM_CTRL,#EEPROM_NOE 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 54.
Hexadecimal [24-Bits]



      0003BA                        349     _ldxz xamadr
      0003BA BE 2B                    1     .byte 0xbe,xamadr 
      0003BC                        350 new_row: 
      0003BC A6 10            [ 1]  351     ld a,#16
      0003BE 6B 01            [ 1]  352     ld (ROW_SIZE,sp),a ; bytes per row 
      0003C0 CD 04 2F         [ 4]  353     call print_adr ; display address and first byte of row 
      0003C3 90 AE 16 C0      [ 2]  354     ldw y,#tib 
      0003C7                        355 row:
      0003C7 CD 04 43         [ 4]  356     call print_mem ; display byte at address  
      0003CA C3 00 2F         [ 2]  357     cpw x,last 
      0003CD 2B 05            [ 1]  358     jrmi 2$
      0003CF                        359 1$:
      0003CF CD 03 EA         [ 4]  360     call print_text 
      0003D2 20 0C            [ 2]  361     jra 9$ 
      0003D4                        362 2$:     
      0003D4 5C               [ 1]  363     incw x 
      0003D5 27 F8            [ 1]  364     jreq 1$ ; overflow 
      0003D7 0A 01            [ 1]  365     dec (ROW_SIZE,sp)
      0003D9 26 EC            [ 1]  366     jrne row
      0003DB CD 03 EA         [ 4]  367     call print_text 
      0003DE 20 DC            [ 2]  368     jra new_row 
      0003E0 5C               [ 1]  369 9$: incw x
      0003E1                        370     _strxz xamadr
      0003E1 BF 2B                    1     .byte 0xbf,xamadr 
      0003E3                        371     _strxz last 
      0003E3 BF 2F                    1     .byte 0xbf,last 
      0003E5                        372     _clrz mode 
      0003E5 3F 2A                    1     .byte 0x3f, mode 
      0003E7                        373     _drop VSIZE 
      0003E7 5B 01            [ 2]    1     addw sp,#VSIZE 
      0003E9 81               [ 4]  374     ret  
                                    375 
                                    376 ;--------------------------------
                                    377 ; print ASCII chr for this row  
                                    378 ;--------------------------------
      0003EA                        379 print_text:
      0003EA 89               [ 2]  380     pushw x 
      0003EB AE 00 02         [ 2]  381     ldw x,#2 
      0003EE CD 01 3C         [ 4]  382     call spaces 
      0003F1 90 7F            [ 1]  383     clr (y)
      0003F3 AE 16 C0         [ 2]  384     ldw x,#tib 
      0003F6 CD 01 06         [ 4]  385     call puts 
      0003F9 CD 01 23         [ 4]  386     call new_line       
      0003FC 85               [ 2]  387     popw x 
      0003FD 81               [ 4]  388     ret 
                                    389 
                                    390 ;----------------------------
                                    391 ; parse hexadecimal number 
                                    392 ; from input buffer 
                                    393 ; input:
                                    394 ;    A   first character 
                                    395 ;    Y   pointer to TIB 
                                    396 ; output: 
                                    397 ;    X     number 
                                    398 ;    Y     point after number 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 55.
Hexadecimal [24-Bits]



                                    399 ;-----------------------------      
      0003FE                        400 parse_hex:
      0003FE 4B 00            [ 1]  401     push #0 ; digits count 
      000400 5F               [ 1]  402     clrw x
      000401                        403 1$:    
      000401 A1 47            [ 1]  404     cp a,#'G 
      000403 2A 21            [ 1]  405     jrpl 9$ 
      000405 A0 30            [ 1]  406     sub a,#'0
      000407 2B 1D            [ 1]  407     jrmi 9$ 
      000409 A1 0A            [ 1]  408     cp a,#10 
      00040B 2B 06            [ 1]  409     jrmi 2$   ; 0..9 
      00040D A1 11            [ 1]  410     cp a,#17 
      00040F 2B 15            [ 1]  411     jrmi 9$ 
      000411 A0 07            [ 1]  412     sub a,#7 
      000413                        413 2$: ; shift hex digit in X 
      000413 4B 04            [ 1]  414     push #4 ; bit count 
      000415 4E               [ 1]  415     swap a ; bits in 7:4 
      000416                        416 3$:
      000416 48               [ 1]  417     sll a 
      000417 59               [ 2]  418     rlcw x 
      000418 0A 01            [ 1]  419     dec (1,sp)
      00041A 26 FA            [ 1]  420     jrne 3$
      00041C 84               [ 1]  421     pop a
      00041D 0C 01            [ 1]  422     inc (1,sp) ; digits count  
      00041F                        423     _next_char 
      00041F 90 F6            [ 1]    1     ld a,(y)
      000421 90 5C            [ 1]    2     incw y 
      000423 4D               [ 1]  424     tnz a 
      000424 26 DB            [ 1]  425     jrne 1$
      000426                        426 9$: ; end of hex number
      000426 90 5A            [ 2]  427     decw y  ; put back last character  
      000428 84               [ 1]  428     pop a ; hex digits count
      000429 4D               [ 1]  429     tnz a 
      00042A 27 02            [ 1]  430     jreq 10$ ; no hex number 
      00042C                        431     _strxz last 
      00042C BF 2F                    1     .byte 0xbf,last 
      00042E                        432 10$:
      00042E 81               [ 4]  433     ret 
                                    434 
                                    435 ;-----------------------------------
                                    436 ;  print address in xamadr variable
                                    437 ;  followed by ': '  
                                    438 ;  input: 
                                    439 ;    X     address to print 
                                    440 ;  output:
                                    441 ;   X      not modified 
                                    442 ;-------------------------------------
      00042F                        443 print_adr: 
      00042F AD 09            [ 4]  444     callr print_word 
      000431 A6 3A            [ 1]  445     ld a,#': 
      000433 CD 00 CF         [ 4]  446     call putc 
      000436 CD 01 34         [ 4]  447     call space
      000439 81               [ 4]  448     ret 
                                    449 
                                    450 ;-------------------------------
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 56.
Hexadecimal [24-Bits]



                                    451 ;  print hexadecimal number 
                                    452 ; input:
                                    453 ;    X  number to print 
                                    454 ; output:
                                    455 ;    none 
                                    456 ;--------------------------------
      00043A                        457 print_word: 
      00043A 9E               [ 1]  458     ld a,xh
      00043B CD 01 B2         [ 4]  459     call print_hex  
      00043E 9F               [ 1]  460     ld a,xl 
      00043F CD 01 B2         [ 4]  461     call print_hex  
      000442 81               [ 4]  462     ret 
                                    463 
                                    464 ;-------------------------------------
                                    465 ;  print byte at memory location 
                                    466 ;  pointed by X followed by ' ' 
                                    467 ;  input:
                                    468 ;     X     memory address 
                                    469 ;  output:
                                    470 ;    X      not modified 
                                    471 ;-------------------------------------
      000443                        472 print_mem:
      000443 CD 04 B5         [ 4]  473     call eeprom_addr 
      000446                        474     _eeprom_read
      000446 C6 50 06         [ 1]    1         ld a,DATA_IDR  
      000449 88               [ 1]  475     push a 
      00044A A1 20            [ 1]  476     cp a,#SPACE  
      00044C 2B 04            [ 1]  477     jrmi 1$ 
      00044E A1 7F            [ 1]  478     cp a,#127
      000450 2B 02            [ 1]  479     jrmi 2$ 
      000452                        480 1$:
      000452 A6 20            [ 1]  481     ld a,#SPACE
      000454                        482 2$:     
      000454 90 F7            [ 1]  483     ld (y),a 
      000456 90 5C            [ 1]  484     incw y
      000458 84               [ 1]  485     pop a 
      000459 CD 01 B2         [ 4]  486     call print_hex  
      00045C CD 01 34         [ 4]  487     call space 
      00045F 81               [ 4]  488     ret 
                                    489 
                                    490 
                                    491 ;------------------------------
                                    492 ; program data in pad to eeprom 
                                    493 ; input:
                                    494 ;    A     byte count 
                                    495 ;    pad   data 
                                    496 ;    storadr  where to store data 
                                    497 ;-------------------------------
      000460                        498 prog_eeprom:
      000460 88               [ 1]  499     push a ; bytes to program 
      000461                        500     _config_write
      000461                          1         _data_output
      000461 A6 FF            [ 1]    1         ld a,#255 
      000463 C7 50 08         [ 1]    2         ld DATA_CR1,a ; push pull output mode 
      000466 C7 50 09         [ 1]    3         ld DATA_CR2,a ; high_speed  
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 57.
Hexadecimal [24-Bits]



      000469 C7 50 07         [ 1]    4         ld DATA_DDR,a ; output mode 
      00046C                          2         _eeprom_disable_output
      00046C 72 14 50 0A      [ 1]    1         bset EEPROM_CTRL,#EEPROM_NOE
      000470 90 AE 17 40      [ 2]  501     ldw y,#pad 
      000474                        502     _ldxz storadr 
      000474 BE 2D                    1     .byte 0xbe,storadr 
      000476                        503 1$:
      000476 CD 04 B5         [ 4]  504     call eeprom_addr 
      000479 5C               [ 1]  505     incw x 
      00047A 90 F6            [ 1]  506     ld a,(y)
      00047C 90 5C            [ 1]  507     incw y 
      00047E                        508     _eeprom_write 
      00047E                          1         _eeprom_we_low 
      00047E 72 17 50 0A      [ 1]    1         bres EEPROM_CTRL,#EEPROM_NWE
      000482 9D               [ 1]    2         nop 
      000483 9D               [ 1]    3         nop 
      000484 C7 50 05         [ 1]    4         ld DATA_ODR,a
      000487 9D               [ 1]    5         nop
      000488 9D               [ 1]    6         nop 
      000489                          7         _eeprom_we_high   
      000489 72 16 50 0A      [ 1]    1         bset EEPROM_CTRL,#EEPROM_NWE
      00048D 0A 01            [ 1]  509     dec (1,sp)
      00048F 26 E5            [ 1]  510     jrne 1$ 
      000491                        511     _strxz storadr 
      000491 BF 2D                    1     .byte 0xbf,storadr 
      000493                        512     _config_read 
      000493                          1         _data_input
      000493 72 5F 50 08      [ 1]    1         clr DATA_CR1  ; floating input
      000497 72 5F 50 09      [ 1]    2         clr DATA_CR2  ; disable ineterrupt
      00049B 72 5F 50 07      [ 1]    3         clr DATA_DDR  ; input mode
      00049F                          2         _eeprom_enabe_output
      00049F 72 15 50 0A      [ 1]    1         bres EEPROM_CTRL,#EEPROM_NOE 
      0004A3                        513     _prog_delay
      0004A3 A6 0A            [ 1]    1         ld a,#10
      0004A5                          2         _straz timer+1
      0004A5 B7 03                    1     .byte 0xb7,timer+1 
      0004A7                          3         _clrz timer  
      0004A7 3F 02                    1     .byte 0x3f, timer 
      0004A9 72 12 00 07      [ 1]    4         bset flags,#FTIMER 
      0004AD 72 02 00 07 FB   [ 2]    5         btjt flags,#FTIMER,.
      0004B2                        514     _drop 1
      0004B2 5B 01            [ 2]    1     addw sp,#1 
      0004B4 81               [ 4]  515     ret 
                                    516 
                                    517 ;---------------------------
                                    518 ; set eeprom address 
                                    519 ; input:
                                    520 ;    X     address 
                                    521 ; output:
                                    522 ;    X     preserved 
                                    523 ;---------------------------
      0004B5                        524 eeprom_addr:
      0004B5 88               [ 1]  525     push a 
      0004B6 9E               [ 1]  526     ld a,xh 
      0004B7 C7 50 1E         [ 1]  527     ld ADDR_HIGH,a 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 58.
Hexadecimal [24-Bits]



      0004BA 9F               [ 1]  528     ld a,xl 
      0004BB C7 50 0F         [ 1]  529     ld ADDR_LOW,a 
      0004BE 84               [ 1]  530     pop a
      0004BF 81               [ 4]  531     ret 
                                    532 
                                    533 ;-----------------------------
                                    534 ; copy tib to eeprom as 
                                    535 ; .asciz 
                                    536 ; input: 
                                    537 ;   tib 
                                    538 ; string max length 63 char.
                                    539 ;-----------------------------
      0004C0                        540 write_string:
      0004C0                        541     _config_write 
      0004C0                          1         _data_output
      0004C0 A6 FF            [ 1]    1         ld a,#255 
      0004C2 C7 50 08         [ 1]    2         ld DATA_CR1,a ; push pull output mode 
      0004C5 C7 50 09         [ 1]    3         ld DATA_CR2,a ; high_speed  
      0004C8 C7 50 07         [ 1]    4         ld DATA_DDR,a ; output mode 
      0004CB                          2         _eeprom_disable_output
      0004CB 72 14 50 0A      [ 1]    1         bset EEPROM_CTRL,#EEPROM_NOE
      0004CF 93               [ 1]  542     ldw x,y 
      0004D0 CD 05 5D         [ 4]  543     call strlen
      0004D3 4D               [ 1]  544     tnz a 
      0004D4 27 48            [ 1]  545     jreq 10$
      0004D6 4C               [ 1]  546     inc a 
      0004D7 A1 40            [ 1]  547     cp a,#EEPROM_PAGE_SIZE
      0004D9 2B 02            [ 1]  548     jrmi 1$ 
      0004DB A6 40            [ 1]  549     ld a,#PAD_SIZE 
      0004DD 88               [ 1]  550 1$: push a 
      0004DE                        551     _ldxz storadr 
      0004DE BE 2D                    1     .byte 0xbe,storadr 
      0004E0                        552 2$:
      0004E0 90 F6            [ 1]  553     ld a,(y)
      0004E2 90 5C            [ 1]  554     incw y 
      0004E4 CD 04 B5         [ 4]  555     call eeprom_addr 
      0004E7 5C               [ 1]  556     incw x 
      0004E8                        557     _eeprom_write 
      0004E8                          1         _eeprom_we_low 
      0004E8 72 17 50 0A      [ 1]    1         bres EEPROM_CTRL,#EEPROM_NWE
      0004EC 9D               [ 1]    2         nop 
      0004ED 9D               [ 1]    3         nop 
      0004EE C7 50 05         [ 1]    4         ld DATA_ODR,a
      0004F1 9D               [ 1]    5         nop
      0004F2 9D               [ 1]    6         nop 
      0004F3                          7         _eeprom_we_high   
      0004F3 72 16 50 0A      [ 1]    1         bset EEPROM_CTRL,#EEPROM_NWE
      0004F7 0A 01            [ 1]  558     dec (1,sp)
      0004F9 26 E5            [ 1]  559     jrne 2$
      0004FB                        560     _strxz storadr
      0004FB BF 2D                    1     .byte 0xbf,storadr 
      0004FD                        561     _prog_delay
      0004FD A6 0A            [ 1]    1         ld a,#10
      0004FF                          2         _straz timer+1
      0004FF B7 03                    1     .byte 0xb7,timer+1 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 59.
Hexadecimal [24-Bits]



      000501                          3         _clrz timer  
      000501 3F 02                    1     .byte 0x3f, timer 
      000503 72 12 00 07      [ 1]    4         bset flags,#FTIMER 
      000507 72 02 00 07 FB   [ 2]    5         btjt flags,#FTIMER,.
      00050C                        562     _config_read 
      00050C                          1         _data_input
      00050C 72 5F 50 08      [ 1]    1         clr DATA_CR1  ; floating input
      000510 72 5F 50 09      [ 1]    2         clr DATA_CR2  ; disable ineterrupt
      000514 72 5F 50 07      [ 1]    3         clr DATA_DDR  ; input mode
      000518                          2         _eeprom_enabe_output
      000518 72 15 50 0A      [ 1]    1         bres EEPROM_CTRL,#EEPROM_NOE 
      00051C                        563     _drop 1  
      00051C 5B 01            [ 2]    1     addw sp,#1 
      00051E                        564 10$:
      00051E 81               [ 4]  565     ret 
                                    566 
                                    567 ;----------------------------
                                    568 ;  erasse EEPROM range 
                                    569 ;  filling with 0xFF value 
                                    570 ;  cmd format: addr1Xaddr2 
                                    571 ;----------------------------
                           000001   572     COUNT=1
                           000002   573     VSIZE=2
      00051F                        574 erase_range:
      00051F                        575     _vars VSIZE 
      00051F 52 02            [ 2]    1     sub sp,#VSIZE 
                                    576 ; fill pad with 0xFF
      000521 0F 01            [ 1]  577     clr (COUNT,sp)
      000523 A6 40            [ 1]  578     ld a,#EEPROM_PAGE_SIZE
      000525 6B 02            [ 1]  579     ld (COUNT+1,sp),a
      000527 AE 17 40         [ 2]  580     ldw x,#pad 
      00052A A6 FF            [ 1]  581     ld a,#0xff 
      00052C                        582 1$: 
      00052C F7               [ 1]  583     ld (x),a 
      00052D 5C               [ 1]  584     incw x 
      00052E 0A 02            [ 1]  585     dec (2,sp)
      000530 26 FA            [ 1]  586     jrne 1$ 
      000532                        587     _ldxz last 
      000532 BE 2F                    1     .byte 0xbe,last 
      000534 72 B0 00 2D      [ 2]  588     subw x,storadr 
      000538 5C               [ 1]  589     incw x 
      000539 1F 01            [ 2]  590     ldw (COUNT,sp),x ; count to erase 
      00053B                        591 2$:
      00053B AE 00 40         [ 2]  592     ldw x,#EEPROM_PAGE_SIZE 
      00053E 13 01            [ 2]  593     cpw x,(COUNT,sp)
      000540 2B 02            [ 1]  594     jrmi 4$ 
      000542 1E 01            [ 2]  595     ldw x,(COUNT,sp)
      000544 9F               [ 1]  596 4$: ld a,xl 
      000545 88               [ 1]  597     push a 
      000546 CD 04 60         [ 4]  598     call prog_eeprom 
      000549 32 00 06         [ 1]  599     pop ptr8 
      00054C 72 5F 00 05      [ 1]  600     clr ptr16 
      000550 1E 01            [ 2]  601     ldw x,(COUNT,sp) 
      000552 72 B0 00 05      [ 2]  602     subw x,ptr16
      000556 1F 01            [ 2]  603     ldw (COUNT,sp),x  
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 60.
Hexadecimal [24-Bits]



      000558 26 E1            [ 1]  604     jrne 2$ 
      00055A                        605     _drop VSIZE 
      00055A 5B 02            [ 2]    1     addw sp,#VSIZE 
      00055C 81               [ 4]  606     ret 
                                    607 
                                    608 ;--------------------------
                                    609 ; return lenght of string
                                    610 ; input:
                                    611 ;    X   *.asciz 
                                    612 ; output:
                                    613 ;    A     length 
                                    614 ;    X     not changed 
                                    615 ;--------------------------
      00055D                        616 strlen:
      00055D 89               [ 2]  617     pushw x
      00055E 4F               [ 1]  618     clr a 
      00055F                        619 1$:
      00055F 7D               [ 1]  620     tnz (x)
      000560 27 04            [ 1]  621     jreq 9$
      000562 4C               [ 1]  622     inc a 
      000563 5C               [ 1]  623     incw x 
      000564 20 F9            [ 2]  624     jra 1$
      000566 85               [ 2]  625 9$: popw x
      000567 81               [ 4]  626     ret 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 61.
Hexadecimal [24-Bits]

Symbol Table

    .__.$$$.=  002710 L   |     .__.ABS.=  000000 G   |     .__.CPU.=  000000 L
    .__.H$L.=  000001 L   |     ACK     =  000006     |     ADC_CR1 =  005401 
    ADC_CR1_=  000000     |     ADC_CR1_=  000001     |     ADC_CR1_=  000004 
    ADC_CR1_=  000005     |     ADC_CR1_=  000006     |     ADC_CR2 =  005402 
    ADC_CR2_=  000003     |     ADC_CR2_=  000004     |     ADC_CR2_=  000005 
    ADC_CR2_=  000006     |     ADC_CR2_=  000001     |     ADC_CR3 =  005403 
    ADC_CR3_=  000007     |     ADC_CR3_=  000006     |     ADC_CSR =  005400 
    ADC_CSR_=  000006     |     ADC_CSR_=  000004     |     ADC_CSR_=  000000 
    ADC_CSR_=  000001     |     ADC_CSR_=  000002     |     ADC_CSR_=  000003 
    ADC_CSR_=  000007     |     ADC_CSR_=  000005     |     ADC_DRH =  005404 
    ADC_DRL =  005405     |     ADC_TDRH=  005406     |     ADC_TDRL=  005407 
    ADDR_HIG=  00501E     |     ADDR_LOW=  00500F     |     AFR     =  004803 
    AFR0_ADC=  000000     |     AFR1_TIM=  000001     |     AFR2_CCO=  000002 
    AFR3_TIM=  000003     |     AFR4_TIM=  000004     |     AFR5_TIM=  000005 
    AFR6_I2C=  000006     |     AFR7_BEE=  000007     |     AWU_APR =  0050F1 
    AWU_CSR =  0050F0     |     AWU_CSR_=  000004     |     AWU_TBR =  0050F2 
    B0_MASK =  000001     |     B115200 =  000006     |     B19200  =  000003 
    B1_MASK =  000002     |     B230400 =  000007     |     B2400   =  000000 
    B2_MASK =  000004     |     B38400  =  000004     |     B3_MASK =  000008 
    B460800 =  000008     |     B4800   =  000001     |     B4_MASK =  000010 
    B57600  =  000005     |     B5_MASK =  000020     |     B6_MASK =  000040 
    B7_MASK =  000080     |     B921600 =  000009     |     B9600   =  000002 
    BAUD_RAT=  01C200     |     BEEP_BIT=  000004     |     BEEP_CSR=  0050F3 
    BEEP_MAS=  000010     |     BEEP_POR=  00000F     |     BELL    =  000007 
    BIT0    =  000000     |     BIT1    =  000001     |     BIT2    =  000002 
    BIT3    =  000003     |     BIT4    =  000004     |     BIT5    =  000005 
    BIT6    =  000006     |     BIT7    =  000007     |     BLOCK_SI=  000080 
    BOOT_ROM=  006000     |     BOOT_ROM=  007FFF     |     BRR1_VAL=  000008 
    BRR2_VAL=  00000B     |     BS      =  000008     |     CAN     =  000018 
    CAN_DGR =  005426     |     CAN_FPSR=  005427     |     CAN_IER =  005425 
    CAN_MCR =  005420     |     CAN_MSR =  005421     |     CAN_P0  =  005428 
    CAN_P1  =  005429     |     CAN_P2  =  00542A     |     CAN_P3  =  00542B 
    CAN_P4  =  00542C     |     CAN_P5  =  00542D     |     CAN_P6  =  00542E 
    CAN_P7  =  00542F     |     CAN_P8  =  005430     |     CAN_P9  =  005431 
    CAN_PA  =  005432     |     CAN_PB  =  005433     |     CAN_PC  =  005434 
    CAN_PD  =  005435     |     CAN_PE  =  005436     |     CAN_PF  =  005437 
    CAN_RFR =  005424     |     CAN_TPR =  005423     |     CAN_TSR =  005422 
    CC_C    =  000000     |     CC_H    =  000004     |     CC_I0   =  000003 
    CC_I1   =  000005     |     CC_N    =  000002     |     CC_V    =  000007 
    CC_Z    =  000001     |     CFG_GCR =  007F60     |     CFG_GCR_=  000001 
    CFG_GCR_=  000000     |     CHAR    =  000003     |     CLKOPT  =  004807 
    CLKOPT_C=  000002     |     CLKOPT_E=  000003     |     CLKOPT_P=  000000 
    CLKOPT_P=  000001     |     CLK_CCOR=  0050C9     |     CLK_CKDI=  0050C6 
    CLK_CKDI=  000000     |     CLK_CKDI=  000001     |     CLK_CKDI=  000002 
    CLK_CKDI=  000003     |     CLK_CKDI=  000004     |     CLK_CMSR=  0050C3 
    CLK_CSSR=  0050C8     |     CLK_ECKR=  0050C1     |     CLK_ECKR=  000000 
    CLK_ECKR=  000001     |     CLK_HSIT=  0050CC     |     CLK_ICKR=  0050C0 
    CLK_ICKR=  000002     |     CLK_ICKR=  000000     |     CLK_ICKR=  000001 
    CLK_ICKR=  000003     |     CLK_ICKR=  000004     |     CLK_ICKR=  000005 
    CLK_PCKE=  0050C7     |     CLK_PCKE=  000000     |     CLK_PCKE=  000001 
    CLK_PCKE=  000007     |     CLK_PCKE=  000005     |     CLK_PCKE=  000006 
    CLK_PCKE=  000004     |     CLK_PCKE=  000002     |     CLK_PCKE=  000003 
    CLK_PCKE=  0050CA     |     CLK_PCKE=  000003     |     CLK_PCKE=  000002 
    CLK_PCKE=  000007     |     CLK_SWCR=  0050C5     |     CLK_SWCR=  000000 
    CLK_SWCR=  000001     |     CLK_SWCR=  000002     |     CLK_SWCR=  000003 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 62.
Hexadecimal [24-Bits]

Symbol Table

    CLK_SWIM=  0050CD     |     CLK_SWR =  0050C4     |     CLK_SWR_=  0000B4 
    CLK_SWR_=  0000E1     |     CLK_SWR_=  0000D2     |     COLON   =  00003A 
    COMMA   =  00002C     |     COUNT   =  000001     |     CPU_A   =  007F00 
    CPU_CCR =  007F0A     |     CPU_PCE =  007F01     |     CPU_PCH =  007F02 
    CPU_PCL =  007F03     |     CPU_SPH =  007F08     |     CPU_SPL =  007F09 
    CPU_XH  =  007F04     |     CPU_XL  =  007F05     |     CPU_YH  =  007F06 
    CPU_YL  =  007F07     |     CR      =  00000D     |     CTRL_A  =  000001 
    CTRL_B  =  000002     |     CTRL_C  =  000003     |     CTRL_D  =  000004 
    CTRL_E  =  000005     |     CTRL_F  =  000006     |     CTRL_G  =  000007 
    CTRL_H  =  000008     |     CTRL_I  =  000009     |     CTRL_J  =  00000A 
    CTRL_K  =  00000B     |     CTRL_L  =  00000C     |     CTRL_M  =  00000D 
    CTRL_N  =  00000E     |     CTRL_O  =  00000F     |     CTRL_P  =  000010 
    CTRL_Q  =  000011     |     CTRL_R  =  000012     |     CTRL_S  =  000013 
    CTRL_T  =  000014     |     CTRL_U  =  000015     |     CTRL_V  =  000016 
    CTRL_W  =  000017     |     CTRL_X  =  000018     |     CTRL_Y  =  000019 
    CTRL_Z  =  00001A     |     DATA_CR1=  005008     |     DATA_CR2=  005009 
    DATA_DDR=  005007     |     DATA_IDR=  005006     |     DATA_ODR=  005005 
    DC1     =  000011     |     DC2     =  000012     |     DC3     =  000013 
    DC4     =  000014     |     DEBUG_BA=  007F00     |     DEBUG_EN=  007FFF 
    DEVID_BA=  0048CD     |     DEVID_EN=  0048D8     |     DEVID_LO=  0048D2 
    DEVID_LO=  0048D3     |     DEVID_LO=  0048D4     |     DEVID_LO=  0048D5 
    DEVID_LO=  0048D6     |     DEVID_LO=  0048D7     |     DEVID_LO=  0048D8 
    DEVID_WA=  0048D1     |     DEVID_XH=  0048CE     |     DEVID_XL=  0048CD 
    DEVID_YH=  0048D0     |     DEVID_YL=  0048CF     |     DLE     =  000010 
    DM_BK1RE=  007F90     |     DM_BK1RH=  007F91     |     DM_BK1RL=  007F92 
    DM_BK2RE=  007F93     |     DM_BK2RH=  007F94     |     DM_BK2RL=  007F95 
    DM_CR1  =  007F96     |     DM_CR2  =  007F97     |     DM_CSR1 =  007F98 
    DM_CSR2 =  007F99     |     DM_ENFCT=  007F9A     |   6 EEPROG_t   00029B R
    EEPROM_B=  004000     |     EEPROM_C=  00500A     |     EEPROM_E=  0047FF 
    EEPROM_N=  000001     |     EEPROM_N=  000002     |     EEPROM_N=  000003 
    EEPROM_P=  000040     |     EEPROM_S=  000800     |     EM      =  000019 
    ENQ     =  000005     |     EOF     =  00001A     |     EOT     =  000004 
    ERASE   =  000003     |     ESC     =  00001B     |     ETB     =  000017 
    ETX     =  000003     |     EXTI_CR1=  0050A0     |     EXTI_CR2=  0050A1 
    FF      =  00000C     |     FHSE    =  7A1200     |     FHSI    =  F42400 
    FLASH_BA=  008000     |     FLASH_CR=  00505A     |     FLASH_CR=  000002 
    FLASH_CR=  000000     |     FLASH_CR=  000003     |     FLASH_CR=  000001 
    FLASH_CR=  00505B     |     FLASH_CR=  000005     |     FLASH_CR=  000004 
    FLASH_CR=  000007     |     FLASH_CR=  000000     |     FLASH_CR=  000006 
    FLASH_DU=  005064     |     FLASH_DU=  0000AE     |     FLASH_DU=  000056 
    FLASH_EN=  027FFF     |     FLASH_FP=  00505D     |     FLASH_FP=  000000 
    FLASH_FP=  000001     |     FLASH_FP=  000002     |     FLASH_FP=  000003 
    FLASH_FP=  000004     |     FLASH_FP=  000005     |     FLASH_IA=  00505F 
    FLASH_IA=  000003     |     FLASH_IA=  000002     |     FLASH_IA=  000006 
    FLASH_IA=  000001     |     FLASH_IA=  000000     |     FLASH_NC=  00505C 
    FLASH_NF=  00505E     |     FLASH_NF=  000000     |     FLASH_NF=  000001 
    FLASH_NF=  000002     |     FLASH_NF=  000003     |     FLASH_NF=  000004 
    FLASH_NF=  000005     |     FLASH_PU=  005062     |     FLASH_PU=  000056 
    FLASH_PU=  0000AE     |     FLASH_SI=  020000     |     FLASH_WS=  00480D 
    FLSI    =  01F400     |     FMSTR   =  000010     |     FS      =  00001C 
    FTIMER  =  000001     |     FUPPER  =  000000     |     GPIO_BAS=  005000 
    GPIO_CR1=  000003     |     GPIO_CR2=  000004     |     GPIO_DDR=  000002 
    GPIO_IDR=  000001     |     GPIO_ODR=  000000     |     GPIO_SIZ=  000005 
    GS      =  00001D     |     HI_LL   =  000001     |     HSECNT  =  004809 
    I2C_BASE=  005210     |     I2C_CCRH=  00521C     |     I2C_CCRH=  000080 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 63.
Hexadecimal [24-Bits]

Symbol Table

    I2C_CCRH=  0000C0     |     I2C_CCRH=  000080     |     I2C_CCRH=  000000 
    I2C_CCRH=  000001     |     I2C_CCRH=  000000     |     I2C_CCRH=  000006 
    I2C_CCRH=  000007     |     I2C_CCRL=  00521B     |     I2C_CCRL=  00001A 
    I2C_CCRL=  000002     |     I2C_CCRL=  00000D     |     I2C_CCRL=  000050 
    I2C_CCRL=  000090     |     I2C_CCRL=  0000A0     |     I2C_CR1 =  005210 
    I2C_CR1_=  000006     |     I2C_CR1_=  000007     |     I2C_CR1_=  000000 
    I2C_CR2 =  005211     |     I2C_CR2_=  000002     |     I2C_CR2_=  000003 
    I2C_CR2_=  000000     |     I2C_CR2_=  000001     |     I2C_CR2_=  000007 
    I2C_DR  =  005216     |     I2C_FREQ=  005212     |     I2C_ITR =  00521A 
    I2C_ITR_=  000002     |     I2C_ITR_=  000000     |     I2C_ITR_=  000001 
    I2C_OARH=  005214     |     I2C_OARH=  000001     |     I2C_OARH=  000002 
    I2C_OARH=  000006     |     I2C_OARH=  000007     |     I2C_OARL=  005213 
    I2C_OARL=  000000     |     I2C_OAR_=  000813     |     I2C_OAR_=  000009 
    I2C_PECR=  00521E     |     I2C_READ=  000001     |     I2C_SR1 =  005217 
    I2C_SR1_=  000003     |     I2C_SR1_=  000001     |     I2C_SR1_=  000002 
    I2C_SR1_=  000006     |     I2C_SR1_=  000000     |     I2C_SR1_=  000004 
    I2C_SR1_=  000007     |     I2C_SR2 =  005218     |     I2C_SR2_=  000002 
    I2C_SR2_=  000001     |     I2C_SR2_=  000000     |     I2C_SR2_=  000003 
    I2C_SR2_=  000005     |     I2C_SR3 =  005219     |     I2C_SR3_=  000001 
    I2C_SR3_=  000007     |     I2C_SR3_=  000004     |     I2C_SR3_=  000000 
    I2C_SR3_=  000002     |     I2C_TRIS=  00521D     |     I2C_TRIS=  000005 
    I2C_TRIS=  000005     |     I2C_TRIS=  000005     |     I2C_TRIS=  000011 
    I2C_TRIS=  000011     |     I2C_TRIS=  000011     |     I2C_WRIT=  000000 
    INPUT_DI=  000000     |     INPUT_EI=  000001     |     INPUT_FL=  000000 
    INPUT_PU=  000001     |     INT_ADC2=  000016     |     INT_AUAR=  000012 
    INT_AWU =  000001     |     INT_CAN_=  000008     |     INT_CAN_=  000009 
    INT_CLK =  000002     |     INT_EXTI=  000003     |     INT_EXTI=  000004 
    INT_EXTI=  000005     |     INT_EXTI=  000006     |     INT_EXTI=  000007 
    INT_FLAS=  000018     |     INT_I2C =  000013     |     INT_SPI =  00000A 
    INT_TIM1=  00000C     |     INT_TIM1=  00000B     |     INT_TIM2=  00000E 
    INT_TIM2=  00000D     |     INT_TIM3=  000010     |     INT_TIM3=  00000F 
    INT_TIM4=  000017     |     INT_TLI =  000000     |     INT_UART=  000011 
    INT_UART=  000015     |     INT_UART=  000014     |     INT_VECT=  008060 
    INT_VECT=  00800C     |     INT_VECT=  008028     |     INT_VECT=  00802C 
    INT_VECT=  008010     |     INT_VECT=  008014     |     INT_VECT=  008018 
    INT_VECT=  00801C     |     INT_VECT=  008020     |     INT_VECT=  008024 
    INT_VECT=  008068     |     INT_VECT=  008054     |     INT_VECT=  008000 
    INT_VECT=  008030     |     INT_VECT=  008038     |     INT_VECT=  008034 
    INT_VECT=  008040     |     INT_VECT=  00803C     |     INT_VECT=  008048 
    INT_VECT=  008044     |     INT_VECT=  008064     |     INT_VECT=  008008 
    INT_VECT=  008004     |     INT_VECT=  008050     |     INT_VECT=  00804C 
    INT_VECT=  00805C     |     INT_VECT=  008058     |     ITC_SPR1=  007F70 
    ITC_SPR2=  007F71     |     ITC_SPR3=  007F72     |     ITC_SPR4=  007F73 
    ITC_SPR5=  007F74     |     ITC_SPR6=  007F75     |     ITC_SPR7=  007F76 
    ITC_SPR8=  007F77     |     ITC_SPR_=  000001     |     ITC_SPR_=  000000 
    ITC_SPR_=  000003     |     IWDG_KEY=  000055     |     IWDG_KEY=  0000CC 
    IWDG_KEY=  0000AA     |     IWDG_KR =  0050E0     |     IWDG_PR =  0050E1 
    IWDG_RLR=  0050E2     |     LED_BIT =  000005     |     LED_MASK=  000020 
    LED_PORT=  00500A     |     LEN     =  000002     |     LF      =  00000A 
    LN_LEN  =  000002     |     MAJOR   =  000001     |     MAX_LEN =  00007F 
    MINOR   =  000000     |     NAFR    =  004804     |     NAK     =  000015 
    NCLKOPT =  004808     |     NFLASH_W=  00480E     |     NHSECNT =  00480A 
    NOP     =  000000     |     NOPT1   =  004802     |     NOPT2   =  004804 
    NOPT3   =  004806     |     NOPT4   =  004808     |     NOPT5   =  00480A 
    NOPT6   =  00480C     |     NOPT7   =  00480E     |     NOPTBL  =  00487F 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 64.
Hexadecimal [24-Bits]

Symbol Table

    NUBC    =  004802     |     NWDGOPT =  004806     |     NWDGOPT_=  FFFFFFFD 
    NWDGOPT_=  FFFFFFFC     |     NWDGOPT_=  FFFFFFFF     |     NWDGOPT_=  FFFFFFFE 
  6 NonHandl   000000 R   |     OFS_UART=  000002     |     OFS_UART=  000003 
    OFS_UART=  000004     |     OFS_UART=  000005     |     OFS_UART=  000006 
    OFS_UART=  000007     |     OFS_UART=  000008     |     OFS_UART=  000009 
    OFS_UART=  000001     |     OFS_UART=  000009     |     OFS_UART=  00000A 
    OFS_UART=  000000     |     OPT0    =  004800     |     OPT1    =  004801 
    OPT2    =  004803     |     OPT3    =  004805     |     OPT4    =  004807 
    OPT5    =  004809     |     OPT6    =  00480B     |     OPT7    =  00480D 
    OPTBL   =  00487E     |     OPTION_B=  004800     |     OPTION_E=  00487F 
    OPTION_S=  000080     |     OUTPUT_F=  000001     |     OUTPUT_O=  000000 
    OUTPUT_P=  000001     |     OUTPUT_S=  000000     |     PA      =  000000 
    PAD_SIZE=  000040     |     PAGE_CNT=  000001     |     PA_BASE =  005000 
    PA_CR1  =  005003     |     PA_CR2  =  005004     |     PA_DDR  =  005002 
    PA_IDR  =  005001     |     PA_ODR  =  005000     |     PB      =  000005 
    PB_BASE =  005005     |     PB_CR1  =  005008     |     PB_CR2  =  005009 
    PB_DDR  =  005007     |     PB_IDR  =  005006     |     PB_ODR  =  005005 
    PC      =  00000A     |     PC_BASE =  00500A     |     PC_CR1  =  00500D 
    PC_CR2  =  00500E     |     PC_DDR  =  00500C     |     PC_IDR  =  00500B 
    PC_ODR  =  00500A     |     PD      =  00000F     |     PD_BASE =  00500F 
    PD_CR1  =  005012     |     PD_CR2  =  005013     |     PD_DDR  =  005011 
    PD_IDR  =  005010     |     PD_ODR  =  00500F     |     PE      =  000014 
    PE_BASE =  005014     |     PE_CR1  =  005017     |     PE_CR2  =  005018 
    PE_DDR  =  005016     |     PE_IDR  =  005015     |     PE_ODR  =  005014 
    PF      =  000019     |     PF_BASE =  005019     |     PF_CR1  =  00501C 
    PF_CR2  =  00501D     |     PF_DDR  =  00501B     |     PF_IDR  =  00501A 
    PF_ODR  =  005019     |     PG      =  00001E     |     PG_BASE =  00501E 
    PG_CR1  =  005021     |     PG_CR2  =  005022     |     PG_DDR  =  005020 
    PG_IDR  =  00501F     |     PG_ODR  =  00501E     |     PH      =  000023 
    PH_BASE =  005023     |     PH_CR1  =  005026     |     PH_CR2  =  005027 
    PH_DDR  =  005025     |     PH_IDR  =  005024     |     PH_ODR  =  005023 
    PI      =  000028     |     PI_BASE =  005028     |     PI_CR1  =  00502B 
    PI_CR2  =  00502C     |     PI_DDR  =  00502A     |     PI_IDR  =  005029 
    PI_ODR  =  005028     |     RAM_BASE=  000000     |     RAM_END =  0017FF 
    RAM_SIZE=  001800     |     READ    =  000001     |     REV     =  000005 
    ROP     =  004800     |     ROW_SIZE=  000001     |     RS      =  00001E 
    RST_SR  =  0050B3     |     RX_QUEUE=  000020 G   |     SEMIC   =  00003B 
    SFR_BASE=  005000     |     SFR_END =  0057FF     |     SHARP   =  000023 
    SI      =  00000F     |     SIGN    =  000001     |     SO      =  00000E 
    SOH     =  000001     |     SPACE   =  000020     |     SPI_CR1 =  005200 
    SPI_CR1_=  000003     |     SPI_CR1_=  000000     |     SPI_CR1_=  000001 
    SPI_CR1_=  000007     |     SPI_CR1_=  000002     |     SPI_CR1_=  000006 
    SPI_CR2 =  005201     |     SPI_CR2_=  000007     |     SPI_CR2_=  000006 
    SPI_CR2_=  000005     |     SPI_CR2_=  000004     |     SPI_CR2_=  000002 
    SPI_CR2_=  000000     |     SPI_CR2_=  000001     |     SPI_CRCP=  005205 
    SPI_DR  =  005204     |     SPI_ICR =  005202     |     SPI_RXCR=  005206 
    SPI_SR  =  005203     |     SPI_SR_B=  000007     |     SPI_SR_C=  000004 
    SPI_SR_M=  000005     |     SPI_SR_O=  000006     |     SPI_SR_R=  000000 
    SPI_SR_T=  000001     |     SPI_SR_W=  000003     |     SPI_TXCR=  005207 
    STACK_EM=  0017FF     |     STACK_SI=  000080     |     STORE   =  000002 
    STX     =  000002     |     SUB     =  00001A     |     SWIM_CSR=  007F80 
    SYN     =  000016     |     TAB     =  000009     |     TIB_SIZE=  000080 
    TICK    =  000027     |     TIM1_ARR=  005262     |     TIM1_ARR=  005263 
    TIM1_BKR=  00526D     |     TIM1_CCE=  00525C     |     TIM1_CCE=  00525D 
    TIM1_CCM=  005258     |     TIM1_CCM=  000000     |     TIM1_CCM=  000001 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 65.
Hexadecimal [24-Bits]

Symbol Table

    TIM1_CCM=  000004     |     TIM1_CCM=  000005     |     TIM1_CCM=  000006 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000003 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000004 
    TIM1_CCM=  000005     |     TIM1_CCM=  000006     |     TIM1_CCM=  000003 
    TIM1_CCM=  005259     |     TIM1_CCM=  000000     |     TIM1_CCM=  000001 
    TIM1_CCM=  000004     |     TIM1_CCM=  000005     |     TIM1_CCM=  000006 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000003 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000004 
    TIM1_CCM=  000005     |     TIM1_CCM=  000006     |     TIM1_CCM=  000003 
    TIM1_CCM=  00525A     |     TIM1_CCM=  000000     |     TIM1_CCM=  000001 
    TIM1_CCM=  000004     |     TIM1_CCM=  000005     |     TIM1_CCM=  000006 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000003 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000004 
    TIM1_CCM=  000005     |     TIM1_CCM=  000006     |     TIM1_CCM=  000003 
    TIM1_CCM=  00525B     |     TIM1_CCM=  000000     |     TIM1_CCM=  000001 
    TIM1_CCM=  000004     |     TIM1_CCM=  000005     |     TIM1_CCM=  000006 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000003 
    TIM1_CCM=  000007     |     TIM1_CCM=  000002     |     TIM1_CCM=  000004 
    TIM1_CCM=  000005     |     TIM1_CCM=  000006     |     TIM1_CCM=  000003 
    TIM1_CCR=  005265     |     TIM1_CCR=  005266     |     TIM1_CCR=  005267 
    TIM1_CCR=  005268     |     TIM1_CCR=  005269     |     TIM1_CCR=  00526A 
    TIM1_CCR=  00526B     |     TIM1_CCR=  00526C     |     TIM1_CNT=  00525E 
    TIM1_CNT=  00525F     |     TIM1_CR1=  005250     |     TIM1_CR2=  005251 
    TIM1_CR2=  000000     |     TIM1_CR2=  000002     |     TIM1_CR2=  000004 
    TIM1_CR2=  000005     |     TIM1_CR2=  000006     |     TIM1_DTR=  00526E 
    TIM1_EGR=  005257     |     TIM1_EGR=  000007     |     TIM1_EGR=  000001 
    TIM1_EGR=  000002     |     TIM1_EGR=  000003     |     TIM1_EGR=  000004 
    TIM1_EGR=  000005     |     TIM1_EGR=  000006     |     TIM1_EGR=  000000 
    TIM1_ETR=  005253     |     TIM1_ETR=  000006     |     TIM1_ETR=  000000 
    TIM1_ETR=  000001     |     TIM1_ETR=  000002     |     TIM1_ETR=  000003 
    TIM1_ETR=  000007     |     TIM1_ETR=  000004     |     TIM1_ETR=  000005 
    TIM1_IER=  005254     |     TIM1_IER=  000007     |     TIM1_IER=  000001 
    TIM1_IER=  000002     |     TIM1_IER=  000003     |     TIM1_IER=  000004 
    TIM1_IER=  000005     |     TIM1_IER=  000006     |     TIM1_IER=  000000 
    TIM1_OIS=  00526F     |     TIM1_PSC=  005260     |     TIM1_PSC=  005261 
    TIM1_RCR=  005264     |     TIM1_SMC=  005252     |     TIM1_SMC=  000007 
    TIM1_SMC=  000000     |     TIM1_SMC=  000001     |     TIM1_SMC=  000002 
    TIM1_SMC=  000004     |     TIM1_SMC=  000005     |     TIM1_SMC=  000006 
    TIM1_SR1=  005255     |     TIM1_SR1=  000007     |     TIM1_SR1=  000001 
    TIM1_SR1=  000002     |     TIM1_SR1=  000003     |     TIM1_SR1=  000004 
    TIM1_SR1=  000005     |     TIM1_SR1=  000006     |     TIM1_SR1=  000000 
    TIM1_SR2=  005256     |     TIM1_SR2=  000001     |     TIM1_SR2=  000002 
    TIM1_SR2=  000003     |     TIM1_SR2=  000004     |     TIM2_ARR=  00530D 
    TIM2_ARR=  00530E     |     TIM2_CCE=  005308     |     TIM2_CCE=  000000 
    TIM2_CCE=  000001     |     TIM2_CCE=  000004     |     TIM2_CCE=  000005 
    TIM2_CCE=  005309     |     TIM2_CCM=  005305     |     TIM2_CCM=  005306 
    TIM2_CCM=  005307     |     TIM2_CCM=  000000     |     TIM2_CCM=  000004 
    TIM2_CCM=  000003     |     TIM2_CCR=  00530F     |     TIM2_CCR=  005310 
    TIM2_CCR=  005311     |     TIM2_CCR=  005312     |     TIM2_CCR=  005313 
    TIM2_CCR=  005314     |     TIM2_CLK=  00F424     |     TIM2_CNT=  00530A 
    TIM2_CNT=  00530B     |     TIM2_CR1=  005300     |     TIM2_CR1=  000007 
    TIM2_CR1=  000000     |     TIM2_CR1=  000003     |     TIM2_CR1=  000001 
    TIM2_CR1=  000002     |     TIM2_EGR=  005304     |     TIM2_EGR=  000001 
    TIM2_EGR=  000002     |     TIM2_EGR=  000003     |     TIM2_EGR=  000006 
    TIM2_EGR=  000000     |     TIM2_IER=  005301     |     TIM2_PSC=  00530C 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 66.
Hexadecimal [24-Bits]

Symbol Table

    TIM2_SR1=  005302     |     TIM2_SR2=  005303     |     TIM3_ARR=  00532B 
    TIM3_ARR=  00532C     |     TIM3_CCE=  005327     |     TIM3_CCE=  000000 
    TIM3_CCE=  000001     |     TIM3_CCE=  000004     |     TIM3_CCE=  000005 
    TIM3_CCE=  000000     |     TIM3_CCE=  000001     |     TIM3_CCM=  005325 
    TIM3_CCM=  005326     |     TIM3_CCM=  000000     |     TIM3_CCM=  000004 
    TIM3_CCM=  000003     |     TIM3_CCR=  00532D     |     TIM3_CCR=  00532E 
    TIM3_CCR=  00532F     |     TIM3_CCR=  005330     |     TIM3_CNT=  005328 
    TIM3_CNT=  005329     |     TIM3_CR1=  005320     |     TIM3_CR1=  000007 
    TIM3_CR1=  000000     |     TIM3_CR1=  000003     |     TIM3_CR1=  000001 
    TIM3_CR1=  000002     |     TIM3_EGR=  005324     |     TIM3_IER=  005321 
    TIM3_PSC=  00532A     |     TIM3_SR1=  005322     |     TIM3_SR2=  005323 
    TIM4_ARR=  005346     |     TIM4_CNT=  005344     |     TIM4_CR1=  005340 
    TIM4_CR1=  000007     |     TIM4_CR1=  000000     |     TIM4_CR1=  000003 
    TIM4_CR1=  000001     |     TIM4_CR1=  000002     |     TIM4_EGR=  005343 
    TIM4_EGR=  000000     |     TIM4_IER=  005341     |     TIM4_IER=  000000 
    TIM4_PSC=  005345     |     TIM4_PSC=  000000     |     TIM4_PSC=  000007 
    TIM4_PSC=  000004     |     TIM4_PSC=  000001     |     TIM4_PSC=  000005 
    TIM4_PSC=  000002     |     TIM4_PSC=  000006     |     TIM4_PSC=  000003 
    TIM4_PSC=  000000     |     TIM4_PSC=  000001     |     TIM4_PSC=  000002 
    TIM4_SR =  005342     |     TIM4_SR_=  000000     |     TIM_CR1_=  000007 
    TIM_CR1_=  000000     |     TIM_CR1_=  000006     |     TIM_CR1_=  000005 
    TIM_CR1_=  000004     |     TIM_CR1_=  000003     |     TIM_CR1_=  000001 
    TIM_CR1_=  000002     |   6 Timer4Up   000004 R   |     UART    =  000000 
    UART1   =  000000     |     UART1_BA=  005230     |     UART1_BR=  005232 
    UART1_BR=  005233     |     UART1_CR=  005234     |     UART1_CR=  005235 
    UART1_CR=  005236     |     UART1_CR=  005237     |     UART1_CR=  005238 
    UART1_DR=  005231     |     UART1_GT=  005239     |     UART1_PO=  000000 
    UART1_PS=  00523A     |     UART1_RX=  000004     |     UART1_SR=  005230 
    UART1_TX=  000005     |     UART2   =  000001     |     UART3   =  000002 
    UART3_BA=  005240     |     UART3_BR=  005242     |     UART3_BR=  005243 
    UART3_CR=  005244     |     UART3_CR=  005245     |     UART3_CR=  005246 
    UART3_CR=  005247     |     UART3_CR=  004249     |     UART3_DR=  005241 
    UART3_PO=  00000F     |     UART3_RX=  000006     |     UART3_SR=  005240 
    UART3_TX=  000005     |     UART_BRR=  005232     |     UART_BRR=  005233 
    UART_CR1=  005234     |     UART_CR1=  000004     |     UART_CR1=  000002 
    UART_CR1=  000000     |     UART_CR1=  000001     |     UART_CR1=  000007 
    UART_CR1=  000006     |     UART_CR1=  000005     |     UART_CR1=  000003 
    UART_CR2=  005235     |     UART_CR2=  000004     |     UART_CR2=  000002 
    UART_CR2=  000005     |     UART_CR2=  000001     |     UART_CR2=  000000 
    UART_CR2=  000006     |     UART_CR2=  000003     |     UART_CR2=  000007 
    UART_CR3=  000003     |     UART_CR3=  000001     |     UART_CR3=  000002 
    UART_CR3=  000000     |     UART_CR3=  000006     |     UART_CR3=  000004 
    UART_CR3=  000005     |     UART_CR4=  000000     |     UART_CR4=  000001 
    UART_CR4=  000002     |     UART_CR4=  000003     |     UART_CR4=  000004 
    UART_CR4=  000006     |     UART_CR4=  000005     |     UART_CR5=  000003 
    UART_CR5=  000001     |     UART_CR5=  000002     |     UART_CR5=  000004 
    UART_CR5=  000005     |     UART_CR6=  000004     |     UART_CR6=  000007 
    UART_CR6=  000001     |     UART_CR6=  000002     |     UART_CR6=  000000 
    UART_CR6=  000005     |     UART_DR =  005231     |     UART_PCK=  000002 
    UART_POR=  005003     |     UART_POR=  005004     |     UART_POR=  005002 
    UART_POR=  005001     |     UART_POR=  005000     |     UART_RX_=  000004 
    UART_SR =  005230     |     UART_SR_=  000001     |     UART_SR_=  000004 
    UART_SR_=  000002     |     UART_SR_=  000003     |     UART_SR_=  000000 
    UART_SR_=  000005     |     UART_SR_=  000006     |     UART_SR_=  000007 
    UART_TX_=  000005     |     UBC     =  004801     |     US      =  00001F 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 67.
Hexadecimal [24-Bits]

Symbol Table

  6 UartRxHa   00008F R   |     VSIZE   =  000002     |     VT      =  00000B 
    WDGOPT  =  004805     |     WDGOPT_I=  000002     |     WDGOPT_L=  000003 
    WDGOPT_W=  000000     |     WDGOPT_W=  000001     |     WWDG_CR =  0050D1 
    WWDG_WR =  0050D2     |     XOFF    =  000013     |     XON     =  000011 
  5 base       000000 GR  |   6 bksp       000111 GR  |   6 clear_qu   0000CA R
  6 cli        0002FD R   |   6 clr_scre   000129 GR  |   6 cold_sta   00004D R
  6 eeProg     0002CE R   |   6 eeprom_a   0004B5 R   |   6 erase_ra   00051F R
  6 exam_blo   0003A8 R   |   5 farptr     000004 R   |   5 flags      000007 GR
  5 fmstr      000001 GR  |   6 getc       0000DE GR  |   6 init_por   00025C R
  6 itoa       0001FA GR  |   6 itoa_loo   00021F R   |   5 last       00002F R
  5 mode       00002A R   |   6 new_line   000123 GR  |   6 new_row    0003BC R
  6 next_cha   000311 R   |   2 pad        001740 GR  |   6 parse01    000323 R
  6 parse_he   0003FE R   |   6 print_ad   00042F R   |   6 print_de   0001C2 R
  6 print_he   0001B2 GR  |   6 print_in   0001E9 GR  |   6 print_me   000443 R
  6 print_te   0003EA R   |   6 print_wo   00043A R   |   6 prog_eep   000460 R
  6 prt_digi   0001E1 R   |   6 prt_i8     0001E7 R   |   5 ptr16      000005 GR
  5 ptr8       000006 R   |   6 putc       0000CF GR  |   6 puts       000106 GR
  6 qgetc      0000D8 GR  |   6 readln     000148 GR  |   6 row        0003C7 R
  5 rx1_head   000008 GR  |   5 rx1_queu   00000A GR  |   5 rx1_tail   000009 GR
  6 space      000134 GR  |   6 spaces     00013C GR  |   2 stack_fu   001780 GR
  2 stack_un   001800 R   |   5 storadr    00002D R   |   6 strlen     00055D R
  2 tib        0016C0 R   |   5 timer      000002 GR  |   6 timer4_i   000019 R
  6 to_hex_c   0001A7 GR  |   6 to_upper   000251 R   |   6 uart_bks   000111 GR
  6 uart_get   0000DE GR  |   6 uart_ini   0000AB R   |   6 uart_put   0000CF GR
  6 uart_qge   0000D8 GR  |   2 write_bu   001740 GR  |   6 write_ee   000372 R
  6 write_st   0004C0 R   |   5 xamadr     00002B R

ASxxxx Assembler V02.00 + NoICE + SDCC mods  (STMicroelectronics STM8), page 68.
Hexadecimal [24-Bits]

Area Table

   0 _CODE      size      0   flags    0
   1 SSEG       size      0   flags    8
   2 SSEG0      size    140   flags    8
   3 HOME       size     80   flags    0
   4 DATA       size      0   flags    8
   5 DATA1      size     31   flags    8
   6 CODE       size    568   flags    0

